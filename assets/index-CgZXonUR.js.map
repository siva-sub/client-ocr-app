{"version":3,"file":"index-CgZXonUR.js","sources":["../../node_modules/store2/dist/store2.js","../../src/ocr-cache-manager.js","../../src/onnx-ocr-preprocessing.js","../../src/onnx-ocr-postprocessing.js","../../src/ppocr-v5-onnx-engine.js","../../src/onnx-ocr-advanced.js","../../node_modules/regenerator-runtime/runtime.js","../../node_modules/tesseract.js/src/utils/getId.js","../../node_modules/tesseract.js/src/createJob.js","../../node_modules/tesseract.js/src/utils/log.js","../../node_modules/is-electron/index.js","../../node_modules/tesseract.js/src/utils/getEnvironment.js","../../node_modules/tesseract.js/src/utils/resolvePaths.js","../../node_modules/tesseract.js/src/utils/circularize.js","../../node_modules/tesseract.js/src/constants/OEM.js","../../node_modules/tesseract.js/src/constants/defaultOptions.js","../../node_modules/tesseract.js/src/worker/browser/defaultOptions.js","../../node_modules/tesseract.js/src/worker/browser/spawnWorker.js","../../node_modules/tesseract.js/src/worker/browser/terminateWorker.js","../../node_modules/tesseract.js/src/worker/browser/onMessage.js","../../node_modules/tesseract.js/src/worker/browser/send.js","../../node_modules/tesseract.js/src/worker/browser/loadImage.js","../../node_modules/tesseract.js/src/worker/browser/index.js","../../node_modules/tesseract.js/src/createWorker.js","../../node_modules/tesseract.js/src/Tesseract.js","../../node_modules/tesseract.js/src/index.js","../../src/utils.js","../../src/config.js","../../src/main-mantine.js","../../index.html?html-proxy&index=1.js"],"sourcesContent":["/*! store2 - v2.14.4 - 2024-12-26\n* Copyright (c) 2024 Nathan Bubna; Licensed MIT */\n;(function(window, define) {\n    var _ = {\n        version: \"2.14.4\",\n        areas: {},\n        apis: {},\n        nsdelim: '.',\n\n        // utilities\n        inherit: function(api, o) {\n            for (var p in api) {\n                if (!o.hasOwnProperty(p)) {\n                    Object.defineProperty(o, p, Object.getOwnPropertyDescriptor(api, p));\n                }\n            }\n            return o;\n        },\n        stringify: function(d, fn) {\n            return d === undefined || typeof d === \"function\" ? d+'' : JSON.stringify(d,fn||_.replace);\n        },\n        parse: function(s, fn) {\n            // if it doesn't parse, return as is\n            try{ return JSON.parse(s,fn||_.revive); }catch(e){ return s; }\n        },\n\n        // extension hooks\n        fn: function(name, fn) {\n            _.storeAPI[name] = fn;\n            for (var api in _.apis) {\n                _.apis[api][name] = fn;\n            }\n        },\n        get: function(area, key){ return area.getItem(key); },\n        set: function(area, key, string){ area.setItem(key, string); },\n        remove: function(area, key){ area.removeItem(key); },\n        key: function(area, i){ return area.key(i); },\n        length: function(area){ return area.length; },\n        clear: function(area){ area.clear(); },\n\n        // core functions\n        Store: function(id, area, namespace) {\n            var store = _.inherit(_.storeAPI, function(key, data, overwrite) {\n                if (arguments.length === 0){ return store.getAll(); }\n                if (typeof data === \"function\"){ return store.transact(key, data, overwrite); }// fn=data, alt=overwrite\n                if (data !== undefined){ return store.set(key, data, overwrite); }\n                if (typeof key === \"string\" || typeof key === \"number\"){ return store.get(key); }\n                if (typeof key === \"function\"){ return store.each(key); }\n                if (!key){ return store.clear(); }\n                return store.setAll(key, data);// overwrite=data, data=key\n            });\n            store._id = id;\n            try {\n                var testKey = '__store2_test';\n                area.setItem(testKey, 'ok');\n                store._area = area;\n                area.removeItem(testKey);\n            } catch (e) {\n                store._area = _.storage('fake');\n            }\n            store._ns = namespace || '';\n            if (!_.areas[id]) {\n                _.areas[id] = store._area;\n            }\n            if (!_.apis[store._ns+store._id]) {\n                _.apis[store._ns+store._id] = store;\n            }\n            return store;\n        },\n        storeAPI: {\n            // admin functions\n            area: function(id, area) {\n                var store = this[id];\n                if (!store || !store.area) {\n                    store = _.Store(id, area, this._ns);//new area-specific api in this namespace\n                    if (!this[id]){ this[id] = store; }\n                }\n                return store;\n            },\n            namespace: function(namespace, singleArea, delim) {\n                delim = delim || this._delim || _.nsdelim;\n                if (!namespace){\n                    return this._ns ? this._ns.substring(0,this._ns.length-delim.length) : '';\n                }\n                var ns = namespace, store = this[ns];\n                if (!store || !store.namespace) {\n                    store = _.Store(this._id, this._area, this._ns+ns+delim);//new namespaced api\n                    store._delim = delim;\n                    if (!this[ns]){ this[ns] = store; }\n                    if (!singleArea) {\n                        for (var name in _.areas) {\n                            store.area(name, _.areas[name]);\n                        }\n                    }\n                }\n                return store;\n            },\n            isFake: function(force) {\n                if (force) {\n                    this._real = this._area;\n                    this._area = _.storage('fake');\n                } else if (force === false) {\n                    this._area = this._real || this._area;\n                }\n                return this._area.name === 'fake';\n            },\n            toString: function() {\n                return 'store'+(this._ns?'.'+this.namespace():'')+'['+this._id+']';\n            },\n\n            // storage functions\n            has: function(key) {\n                if (this._area.has) {\n                    return this._area.has(this._in(key));//extension hook\n                }\n                return !!(this._in(key) in this._area);\n            },\n            size: function(){ return this.keys().length; },\n            each: function(fn, fill) {// fill is used by keys(fillList) and getAll(fillList))\n                for (var i=0, m=_.length(this._area); i<m; i++) {\n                    var key = this._out(_.key(this._area, i));\n                    if (key !== undefined) {\n                        if (fn.call(this, key, this.get(key), fill) === false) {\n                            break;\n                        }\n                    }\n                    if (m > _.length(this._area)) { m--; i--; }// in case of removeItem\n                }\n                return fill || this;\n            },\n            keys: function(fillList) {\n                return this.each(function(k, v, list){ list.push(k); }, fillList || []);\n            },\n            get: function(key, alt) {\n                var s = _.get(this._area, this._in(key)),\n                    fn;\n                if (typeof alt === \"function\") {\n                    fn = alt;\n                    alt = null;\n                }\n                return s !== null ? _.parse(s, fn) :\n                    alt != null ? alt : s;\n            },\n            getAll: function(fillObj) {\n                return this.each(function(k, v, all){ all[k] = v; }, fillObj || {});\n            },\n            transact: function(key, fn, alt) {\n                var val = this.get(key, alt),\n                    ret = fn(val);\n                this.set(key, ret === undefined ? val : ret);\n                return this;\n            },\n            set: function(key, data, overwrite) {\n                var d = this.get(key),\n                    replacer;\n                if (d != null && overwrite === false) {\n                    return data;\n                }\n                if (typeof overwrite === \"function\") {\n                    replacer = overwrite;\n                    overwrite = undefined;\n                }\n                return _.set(this._area, this._in(key), _.stringify(data, replacer), overwrite) || d;\n            },\n            setAll: function(data, overwrite) {\n                var changed, val;\n                for (var key in data) {\n                    val = data[key];\n                    if (this.set(key, val, overwrite) !== val) {\n                        changed = true;\n                    }\n                }\n                return changed;\n            },\n            add: function(key, data, replacer) {\n                var d = this.get(key);\n                if (d instanceof Array) {\n                    data = d.concat(data);\n                } else if (d !== null) {\n                    var type = typeof d;\n                    if (type === typeof data && type === 'object') {\n                        for (var k in data) {\n                            d[k] = data[k];\n                        }\n                        data = d;\n                    } else {\n                        data = d + data;\n                    }\n                }\n                _.set(this._area, this._in(key), _.stringify(data, replacer));\n                return data;\n            },\n            remove: function(key, alt) {\n                var d = this.get(key, alt);\n                _.remove(this._area, this._in(key));\n                return d;\n            },\n            clear: function() {\n                if (!this._ns) {\n                    _.clear(this._area);\n                } else {\n                    this.each(function(k){ _.remove(this._area, this._in(k)); }, 1);\n                }\n                return this;\n            },\n            clearAll: function() {\n                var area = this._area;\n                for (var id in _.areas) {\n                    if (_.areas.hasOwnProperty(id)) {\n                        this._area = _.areas[id];\n                        this.clear();\n                    }\n                }\n                this._area = area;\n                return this;\n            },\n\n            // internal use functions\n            _in: function(k) {\n                if (typeof k !== \"string\"){ k = _.stringify(k); }\n                return this._ns ? this._ns + k : k;\n            },\n            _out: function(k) {\n                return this._ns ?\n                    k && k.indexOf(this._ns) === 0 ?\n                        k.substring(this._ns.length) :\n                        undefined : // so each() knows to skip it\n                    k;\n            }\n        },// end _.storeAPI\n        storage: function(name) {\n            return _.inherit(_.storageAPI, { items: {}, name: name });\n        },\n        storageAPI: {\n            length: 0,\n            has: function(k){ return this.items.hasOwnProperty(k); },\n            key: function(i) {\n                var c = 0;\n                for (var k in this.items){\n                    if (this.has(k) && i === c++) {\n                        return k;\n                    }\n                }\n            },\n            setItem: function(k, v) {\n                if (!this.has(k)) {\n                    this.length++;\n                }\n                this.items[k] = v;\n            },\n            removeItem: function(k) {\n                if (this.has(k)) {\n                    delete this.items[k];\n                    this.length--;\n                }\n            },\n            getItem: function(k){ return this.has(k) ? this.items[k] : null; },\n            clear: function(){ for (var k in this.items){ this.removeItem(k); } }\n        }// end _.storageAPI\n    };\n\n    var store =\n        // safely set this up (throws error in IE10/32bit mode for local files)\n        _.Store(\"local\", (function(){try{ return localStorage; }catch(e){}})());\n    store.local = store;// for completeness\n    store._ = _;// for extenders and debuggers...\n    // safely setup store.session (throws exception in FF for file:/// urls)\n    store.area(\"session\", (function(){try{ return sessionStorage; }catch(e){}})());\n    store.area(\"page\", _.storage(\"page\"));\n\n    if (typeof define === 'function' && define.amd !== undefined) {\n        define('store2', [], function () {\n            return store;\n        });\n    } else if (typeof module !== 'undefined' && module.exports) {\n        module.exports = store;\n    } else {\n        // expose the primary store fn to the global object and save conflicts\n        if (window.store){ _.conflict = window.store; }\n        window.store = store;\n    }\n\n})(this, this && this.define);\n","import store from 'store2';\n\n/**\n * OCR Cache Manager using store2\n * Provides intelligent caching for OCR results with automatic cleanup\n */\nexport class OCRCacheManager {\n    constructor(options = {}) {\n        this.namespace = options.namespace || 'ocr-cache';\n        this.maxCacheSize = options.maxCacheSize || 50 * 1024 * 1024; // 50MB default\n        this.maxAge = options.maxAge || 7 * 24 * 60 * 60 * 1000; // 7 days default\n        this.store = store.namespace(this.namespace);\n        \n        // Initialize cache metadata\n        if (!this.store.get('metadata')) {\n            this.store.set('metadata', {\n                version: '1.0',\n                created: Date.now(),\n                totalSize: 0,\n                entries: {}\n            });\n        }\n        \n        // Clean old entries on initialization\n        this.cleanupOldEntries();\n    }\n    \n    /**\n     * Generate cache key from image data\n     */\n    generateCacheKey(imageData, engineType, modelVersion) {\n        // Create a unique key based on image content and processing parameters\n        const dataStr = typeof imageData === 'string' ? imageData : JSON.stringify(imageData);\n        const keyData = `${dataStr}-${engineType}-${modelVersion}`;\n        \n        // Simple hash function for key generation\n        let hash = 0;\n        for (let i = 0; i < keyData.length; i++) {\n            const char = keyData.charCodeAt(i);\n            hash = ((hash << 5) - hash) + char;\n            hash = hash & hash; // Convert to 32-bit integer\n        }\n        \n        return `ocr-${Math.abs(hash).toString(36)}`;\n    }\n    \n    /**\n     * Get cached OCR result\n     */\n    get(imageData, engineType, modelVersion) {\n        const key = this.generateCacheKey(imageData, engineType, modelVersion);\n        const entry = this.store.get(key);\n        \n        if (!entry) {\n            return null;\n        }\n        \n        // Check if entry is expired\n        if (Date.now() - entry.timestamp > this.maxAge) {\n            this.remove(key);\n            return null;\n        }\n        \n        // Update last accessed time\n        entry.lastAccessed = Date.now();\n        this.store.set(key, entry);\n        \n        return entry.data;\n    }\n    \n    /**\n     * Cache OCR result\n     */\n    set(imageData, engineType, modelVersion, ocrResult) {\n        const key = this.generateCacheKey(imageData, engineType, modelVersion);\n        const dataStr = JSON.stringify(ocrResult);\n        const size = new Blob([dataStr]).size;\n        \n        // Check if we need to make room\n        this.ensureCacheSpace(size);\n        \n        const entry = {\n            timestamp: Date.now(),\n            lastAccessed: Date.now(),\n            engineType,\n            modelVersion,\n            size,\n            data: ocrResult\n        };\n        \n        // Update metadata\n        const metadata = this.store.get('metadata');\n        metadata.totalSize += size;\n        metadata.entries[key] = {\n            size,\n            timestamp: entry.timestamp\n        };\n        this.store.set('metadata', metadata);\n        \n        // Store the entry\n        this.store.set(key, entry);\n        \n        return key;\n    }\n    \n    /**\n     * Remove cached entry\n     */\n    remove(key) {\n        const entry = this.store.get(key);\n        if (entry) {\n            const metadata = this.store.get('metadata');\n            if (metadata.entries[key]) {\n                metadata.totalSize -= metadata.entries[key].size;\n                delete metadata.entries[key];\n                this.store.set('metadata', metadata);\n            }\n            this.store.remove(key);\n        }\n    }\n    \n    /**\n     * Clear all cache\n     */\n    clear() {\n        const keys = this.store.keys();\n        keys.forEach(key => {\n            if (key !== 'metadata') {\n                this.store.remove(key);\n            }\n        });\n        \n        // Reset metadata\n        this.store.set('metadata', {\n            version: '1.0',\n            created: Date.now(),\n            totalSize: 0,\n            entries: {}\n        });\n    }\n    \n    /**\n     * Get cache statistics\n     */\n    getStats() {\n        const metadata = this.store.get('metadata');\n        const entries = Object.keys(metadata.entries).length;\n        \n        return {\n            totalSize: metadata.totalSize,\n            maxSize: this.maxCacheSize,\n            usagePercent: (metadata.totalSize / this.maxCacheSize) * 100,\n            entries,\n            oldestEntry: this.getOldestEntry(),\n            newestEntry: this.getNewestEntry()\n        };\n    }\n    \n    /**\n     * Clean up old entries\n     */\n    cleanupOldEntries() {\n        const now = Date.now();\n        const metadata = this.store.get('metadata');\n        const keysToRemove = [];\n        \n        Object.entries(metadata.entries).forEach(([key, info]) => {\n            if (now - info.timestamp > this.maxAge) {\n                keysToRemove.push(key);\n            }\n        });\n        \n        keysToRemove.forEach(key => this.remove(key));\n    }\n    \n    /**\n     * Ensure there's enough space in cache\n     */\n    ensureCacheSpace(requiredSize) {\n        const metadata = this.store.get('metadata');\n        \n        if (metadata.totalSize + requiredSize <= this.maxCacheSize) {\n            return;\n        }\n        \n        // Remove oldest entries until we have enough space\n        const entries = Object.entries(metadata.entries)\n            .sort((a, b) => a[1].timestamp - b[1].timestamp);\n        \n        let currentSize = metadata.totalSize;\n        for (const [key] of entries) {\n            if (currentSize + requiredSize <= this.maxCacheSize) {\n                break;\n            }\n            \n            const entry = this.store.get(key);\n            if (entry) {\n                currentSize -= entry.size;\n                this.remove(key);\n            }\n        }\n    }\n    \n    /**\n     * Get oldest entry info\n     */\n    getOldestEntry() {\n        const metadata = this.store.get('metadata');\n        let oldest = null;\n        \n        Object.entries(metadata.entries).forEach(([key, info]) => {\n            if (!oldest || info.timestamp < oldest.timestamp) {\n                oldest = { key, ...info };\n            }\n        });\n        \n        return oldest;\n    }\n    \n    /**\n     * Get newest entry info\n     */\n    getNewestEntry() {\n        const metadata = this.store.get('metadata');\n        let newest = null;\n        \n        Object.entries(metadata.entries).forEach(([key, info]) => {\n            if (!newest || info.timestamp > newest.timestamp) {\n                newest = { key, ...info };\n            }\n        });\n        \n        return newest;\n    }\n    \n    /**\n     * Export cache data (for debugging/backup)\n     */\n    export() {\n        const data = {\n            metadata: this.store.get('metadata'),\n            entries: {}\n        };\n        \n        this.store.keys().forEach(key => {\n            if (key !== 'metadata') {\n                data.entries[key] = this.store.get(key);\n            }\n        });\n        \n        return data;\n    }\n    \n    /**\n     * Import cache data\n     */\n    import(data) {\n        if (!data || !data.metadata) {\n            throw new Error('Invalid cache data format');\n        }\n        \n        // Clear existing cache\n        this.clear();\n        \n        // Import metadata\n        this.store.set('metadata', data.metadata);\n        \n        // Import entries\n        Object.entries(data.entries).forEach(([key, entry]) => {\n            this.store.set(key, entry);\n        });\n    }\n}\n\n// Create singleton instance\nexport const ocrCache = new OCRCacheManager();","/**\n * OnnxOCR-based preprocessing functions\n * Pure JavaScript implementation without OpenCV dependency\n */\n\nimport * as ort from 'onnxruntime-web';\n\n/**\n * Image preprocessing utilities\n */\nexport class ImagePreprocessor {\n    /**\n     * Resize image to specified dimensions using canvas\n     */\n    static async resizeImage(imageData, targetWidth, targetHeight) {\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        \n        // Create image from imageData\n        const img = new Image();\n        const blob = new Blob([imageData], { type: 'image/png' });\n        const url = URL.createObjectURL(blob);\n        \n        return new Promise((resolve, reject) => {\n            img.onload = () => {\n                canvas.width = targetWidth;\n                canvas.height = targetHeight;\n                ctx.drawImage(img, 0, 0, targetWidth, targetHeight);\n                \n                const resizedImageData = ctx.getImageData(0, 0, targetWidth, targetHeight);\n                URL.revokeObjectURL(url);\n                resolve(resizedImageData);\n            };\n            img.onerror = reject;\n            img.src = url;\n        });\n    }\n\n    /**\n     * Convert canvas to image data for processing\n     */\n    static canvasToImageData(canvas) {\n        const ctx = canvas.getContext('2d');\n        return ctx.getImageData(0, 0, canvas.width, canvas.height);\n    }\n\n    /**\n     * Normalize image data (subtract mean and divide by std)\n     */\n    static normalizeImageData(imageData, mean = [0.485, 0.456, 0.406], std = [0.229, 0.224, 0.225]) {\n        const data = imageData.data;\n        const normalized = new Float32Array(data.length);\n        \n        for (let i = 0; i < data.length; i += 4) {\n            // RGB channels\n            normalized[i] = ((data[i] / 255.0) - mean[0]) / std[0];\n            normalized[i + 1] = ((data[i + 1] / 255.0) - mean[1]) / std[1];\n            normalized[i + 2] = ((data[i + 2] / 255.0) - mean[2]) / std[2];\n            // Alpha channel (kept as is)\n            normalized[i + 3] = data[i + 3] / 255.0;\n        }\n        \n        return normalized;\n    }\n\n    /**\n     * Convert HWC to CHW format for ONNX\n     */\n    static hwcToChw(imageData, width, height) {\n        const channels = 3;\n        const chw = new Float32Array(channels * height * width);\n        const data = imageData.data || imageData;\n        \n        // Rearrange from HWC to CHW\n        let idx = 0;\n        for (let c = 0; c < channels; c++) {\n            for (let h = 0; h < height; h++) {\n                for (let w = 0; w < width; w++) {\n                    chw[idx++] = data[(h * width + w) * 4 + c];\n                }\n            }\n        }\n        \n        return chw;\n    }\n}\n\n/**\n * Detection preprocessing based on OnnxOCR\n */\nexport class DetectionPreprocessor {\n    constructor(options = {}) {\n        this.limitSideLen = options.det_limit_side_len || 960;\n        this.limitType = options.det_limit_type || 'min';\n        this.mean = options.mean || [0.485, 0.456, 0.406];\n        this.std = options.std || [0.229, 0.224, 0.225];\n        this.scale = options.scale || 1.0 / 255.0;\n    }\n\n    async preprocess(canvas) {\n        const originalWidth = canvas.width;\n        const originalHeight = canvas.height;\n        \n        // Calculate resize dimensions\n        const { targetWidth, targetHeight } = this.calculateResizeDimensions(originalWidth, originalHeight);\n        \n        // Create resized canvas\n        const resizedCanvas = document.createElement('canvas');\n        resizedCanvas.width = targetWidth;\n        resizedCanvas.height = targetHeight;\n        const ctx = resizedCanvas.getContext('2d');\n        ctx.drawImage(canvas, 0, 0, targetWidth, targetHeight);\n        \n        // Get image data\n        const imageData = ctx.getImageData(0, 0, targetWidth, targetHeight);\n        \n        // Normalize the image\n        const normalized = this.normalizeImage(imageData);\n        \n        // Convert to CHW format\n        const tensor = ImagePreprocessor.hwcToChw(normalized, targetWidth, targetHeight);\n        \n        return {\n            tensor,\n            originalShape: [originalHeight, originalWidth],\n            resizedShape: [targetHeight, targetWidth],\n            ratio: [targetHeight / originalHeight, targetWidth / originalWidth]\n        };\n    }\n\n    calculateResizeDimensions(width, height) {\n        let ratio = 1.0;\n        \n        if (this.limitType === 'max') {\n            if (Math.max(height, width) > this.limitSideLen) {\n                ratio = this.limitSideLen / Math.max(height, width);\n            }\n        } else if (this.limitType === 'min') {\n            if (Math.min(height, width) < this.limitSideLen) {\n                ratio = this.limitSideLen / Math.min(height, width);\n            }\n        }\n        \n        let targetHeight = Math.round(height * ratio);\n        let targetWidth = Math.round(width * ratio);\n        \n        // Make divisible by 32\n        targetHeight = Math.max(Math.round(targetHeight / 32) * 32, 32);\n        targetWidth = Math.max(Math.round(targetWidth / 32) * 32, 32);\n        \n        return { targetWidth, targetHeight };\n    }\n\n    normalizeImage(imageData) {\n        const data = imageData.data;\n        const normalized = new Float32Array(data.length / 4 * 3); // RGB only\n        \n        let idx = 0;\n        for (let i = 0; i < data.length; i += 4) {\n            normalized[idx++] = ((data[i] * this.scale) - this.mean[0]) / this.std[0];\n            normalized[idx++] = ((data[i + 1] * this.scale) - this.mean[1]) / this.std[1];\n            normalized[idx++] = ((data[i + 2] * this.scale) - this.mean[2]) / this.std[2];\n        }\n        \n        return normalized;\n    }\n}\n\n/**\n * Classification preprocessing based on OnnxOCR\n */\nexport class ClassificationPreprocessor {\n    constructor(options = {}) {\n        this.imageShape = options.cls_image_shape || [3, 48, 192];\n    }\n\n    async preprocess(canvas) {\n        const [channels, targetHeight, targetWidth] = this.imageShape;\n        const originalWidth = canvas.width;\n        const originalHeight = canvas.height;\n        \n        // Calculate resize width maintaining aspect ratio\n        const ratio = originalWidth / originalHeight;\n        let resizeWidth = Math.ceil(targetHeight * ratio);\n        if (resizeWidth > targetWidth) {\n            resizeWidth = targetWidth;\n        }\n        \n        // Create canvas for resizing\n        const resizedCanvas = document.createElement('canvas');\n        resizedCanvas.width = resizeWidth;\n        resizedCanvas.height = targetHeight;\n        const ctx = resizedCanvas.getContext('2d');\n        ctx.drawImage(canvas, 0, 0, resizeWidth, targetHeight);\n        \n        // Create padded canvas\n        const paddedCanvas = document.createElement('canvas');\n        paddedCanvas.width = targetWidth;\n        paddedCanvas.height = targetHeight;\n        const paddedCtx = paddedCanvas.getContext('2d');\n        paddedCtx.fillStyle = 'black';\n        paddedCtx.fillRect(0, 0, targetWidth, targetHeight);\n        paddedCtx.drawImage(resizedCanvas, 0, 0);\n        \n        // Get image data and normalize\n        const imageData = paddedCtx.getImageData(0, 0, targetWidth, targetHeight);\n        const normalized = this.normalizeImage(imageData);\n        \n        // Convert to CHW format\n        const tensor = ImagePreprocessor.hwcToChw(normalized, targetWidth, targetHeight);\n        \n        return tensor;\n    }\n\n    normalizeImage(imageData) {\n        const data = imageData.data;\n        const normalized = new Float32Array(data.length / 4 * 3);\n        \n        let idx = 0;\n        for (let i = 0; i < data.length; i += 4) {\n            // Normalize: (pixel / 255 - 0.5) / 0.5\n            normalized[idx++] = (data[i] / 255.0 - 0.5) / 0.5;\n            normalized[idx++] = (data[i + 1] / 255.0 - 0.5) / 0.5;\n            normalized[idx++] = (data[i + 2] / 255.0 - 0.5) / 0.5;\n        }\n        \n        return normalized;\n    }\n}\n\n/**\n * Recognition preprocessing based on OnnxOCR\n */\nexport class RecognitionPreprocessor {\n    constructor(options = {}) {\n        this.imageShape = options.rec_image_shape || [3, 48, 320];\n        this.recAlgorithm = options.rec_algorithm || 'SVTR_LCNet';\n    }\n\n    async preprocess(canvas, maxWhRatio = null) {\n        const [channels, targetHeight, targetWidth] = this.imageShape;\n        const originalWidth = canvas.width;\n        const originalHeight = canvas.height;\n        \n        // Calculate max width-height ratio if not provided\n        if (!maxWhRatio) {\n            maxWhRatio = originalWidth / originalHeight;\n        }\n        \n        // Calculate target dimensions\n        let imgW = Math.round(targetHeight * maxWhRatio);\n        if (this.recAlgorithm === 'NRTR' || this.recAlgorithm === 'ViTSTR') {\n            imgW = targetWidth;\n        } else {\n            imgW = Math.min(imgW, targetWidth);\n        }\n        \n        // Calculate resize width maintaining aspect ratio\n        const ratio = originalWidth / originalHeight;\n        let resizeWidth = Math.ceil(targetHeight * ratio);\n        if (resizeWidth > imgW) {\n            resizeWidth = imgW;\n        }\n        \n        // Create canvas for resizing\n        const resizedCanvas = document.createElement('canvas');\n        resizedCanvas.width = resizeWidth;\n        resizedCanvas.height = targetHeight;\n        const ctx = resizedCanvas.getContext('2d');\n        ctx.drawImage(canvas, 0, 0, resizeWidth, targetHeight);\n        \n        // Create padded canvas\n        const paddedCanvas = document.createElement('canvas');\n        paddedCanvas.width = imgW;\n        paddedCanvas.height = targetHeight;\n        const paddedCtx = paddedCanvas.getContext('2d');\n        paddedCtx.fillStyle = 'black';\n        paddedCtx.fillRect(0, 0, imgW, targetHeight);\n        paddedCtx.drawImage(resizedCanvas, 0, 0);\n        \n        // Get image data and normalize\n        const imageData = paddedCtx.getImageData(0, 0, imgW, targetHeight);\n        const normalized = this.normalizeImage(imageData);\n        \n        // Convert to CHW format\n        const tensor = ImagePreprocessor.hwcToChw(normalized, imgW, targetHeight);\n        \n        return {\n            tensor,\n            shape: [1, channels, targetHeight, imgW]\n        };\n    }\n\n    normalizeImage(imageData) {\n        const data = imageData.data;\n        const normalized = new Float32Array(data.length / 4 * 3);\n        \n        let idx = 0;\n        for (let i = 0; i < data.length; i += 4) {\n            // Normalize: (pixel / 255 - 0.5) / 0.5\n            normalized[idx++] = (data[i] / 255.0 - 0.5) / 0.5;\n            normalized[idx++] = (data[i + 1] / 255.0 - 0.5) / 0.5;\n            normalized[idx++] = (data[i + 2] / 255.0 - 0.5) / 0.5;\n        }\n        \n        return normalized;\n    }\n}\n\n/**\n * Crop and rotate text regions from detection results\n */\nexport class TextRegionExtractor {\n    static extractRegion(canvas, points) {\n        // Sort points to get correct order: top-left, top-right, bottom-right, bottom-left\n        const sortedPoints = this.sortPoints(points);\n        \n        // Calculate dimensions of the cropped region\n        const width = Math.max(\n            this.distance(sortedPoints[0], sortedPoints[1]),\n            this.distance(sortedPoints[3], sortedPoints[2])\n        );\n        const height = Math.max(\n            this.distance(sortedPoints[0], sortedPoints[3]),\n            this.distance(sortedPoints[1], sortedPoints[2])\n        );\n        \n        // Create canvas for cropped region\n        const croppedCanvas = document.createElement('canvas');\n        croppedCanvas.width = Math.round(width);\n        croppedCanvas.height = Math.round(height);\n        const ctx = croppedCanvas.getContext('2d');\n        \n        // Calculate perspective transform\n        const srcPoints = sortedPoints;\n        const dstPoints = [\n            [0, 0],\n            [width, 0],\n            [width, height],\n            [0, height]\n        ];\n        \n        // Simple perspective transform using canvas\n        ctx.save();\n        \n        // Draw the transformed image\n        const tempCanvas = document.createElement('canvas');\n        tempCanvas.width = canvas.width;\n        tempCanvas.height = canvas.height;\n        const tempCtx = tempCanvas.getContext('2d');\n        tempCtx.drawImage(canvas, 0, 0);\n        \n        // Use clip path to extract the region\n        ctx.beginPath();\n        ctx.moveTo(0, 0);\n        ctx.lineTo(width, 0);\n        ctx.lineTo(width, height);\n        ctx.lineTo(0, height);\n        ctx.closePath();\n        ctx.clip();\n        \n        // Calculate transform matrix (simplified)\n        const transform = this.getPerspectiveTransform(srcPoints, dstPoints, width, height);\n        ctx.setTransform(transform.a, transform.b, transform.c, transform.d, transform.e, transform.f);\n        ctx.drawImage(canvas, 0, 0);\n        \n        ctx.restore();\n        \n        // Check if rotation is needed (if height > width * 1.5)\n        if (height > width * 1.5) {\n            const rotatedCanvas = document.createElement('canvas');\n            rotatedCanvas.width = croppedCanvas.height;\n            rotatedCanvas.height = croppedCanvas.width;\n            const rotatedCtx = rotatedCanvas.getContext('2d');\n            rotatedCtx.translate(rotatedCanvas.width / 2, rotatedCanvas.height / 2);\n            rotatedCtx.rotate(Math.PI / 2);\n            rotatedCtx.drawImage(croppedCanvas, -croppedCanvas.width / 2, -croppedCanvas.height / 2);\n            return rotatedCanvas;\n        }\n        \n        return croppedCanvas;\n    }\n\n    static sortPoints(points) {\n        // Find center point\n        const center = points.reduce((acc, point) => {\n            return [acc[0] + point[0] / points.length, acc[1] + point[1] / points.length];\n        }, [0, 0]);\n        \n        // Sort points by angle from center\n        const sortedPoints = points.slice().sort((a, b) => {\n            const angleA = Math.atan2(a[1] - center[1], a[0] - center[0]);\n            const angleB = Math.atan2(b[1] - center[1], b[0] - center[0]);\n            return angleA - angleB;\n        });\n        \n        // Find top-left point (minimum sum of x and y)\n        let topLeftIdx = 0;\n        let minSum = sortedPoints[0][0] + sortedPoints[0][1];\n        for (let i = 1; i < sortedPoints.length; i++) {\n            const sum = sortedPoints[i][0] + sortedPoints[i][1];\n            if (sum < minSum) {\n                minSum = sum;\n                topLeftIdx = i;\n            }\n        }\n        \n        // Reorder starting from top-left\n        const reordered = [];\n        for (let i = 0; i < sortedPoints.length; i++) {\n            reordered.push(sortedPoints[(topLeftIdx + i) % sortedPoints.length]);\n        }\n        \n        return reordered;\n    }\n\n    static distance(p1, p2) {\n        const dx = p2[0] - p1[0];\n        const dy = p2[1] - p1[1];\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n\n    static getPerspectiveTransform(src, dst, width, height) {\n        // Simplified perspective transform\n        // For more accurate transform, use a proper perspective transform library\n        const scaleX = width / (src[1][0] - src[0][0]);\n        const scaleY = height / (src[3][1] - src[0][1]);\n        \n        return {\n            a: scaleX,\n            b: 0,\n            c: 0,\n            d: scaleY,\n            e: -src[0][0] * scaleX,\n            f: -src[0][1] * scaleY\n        };\n    }\n}\n\n/**\n * Angle Classification Preprocessor\n * Preprocesses images for angle classification model\n */\nexport class AngleClassificationPreprocessor {\n    constructor(options = {}) {\n        this.mean = options.mean || [0.485, 0.456, 0.406];\n        this.std = options.std || [0.229, 0.224, 0.225];\n        this.cls_image_shape = options.cls_image_shape || [3, 48, 192];\n    }\n\n    async preprocess(canvas) {\n        const [c, h, w] = this.cls_image_shape;\n        \n        // Create a new canvas for preprocessing\n        const processCanvas = document.createElement('canvas');\n        processCanvas.width = w;\n        processCanvas.height = h;\n        const ctx = processCanvas.getContext('2d');\n        \n        // Resize image\n        ctx.drawImage(canvas, 0, 0, w, h);\n        \n        // Get image data\n        const imageData = ctx.getImageData(0, 0, w, h);\n        const data = imageData.data;\n        \n        // Create tensor data\n        const tensorData = new Float32Array(c * h * w);\n        \n        // Normalize and convert to CHW format\n        for (let y = 0; y < h; y++) {\n            for (let x = 0; x < w; x++) {\n                const idx = (y * w + x) * 4;\n                \n                // RGB channels\n                tensorData[0 * h * w + y * w + x] = (data[idx] / 255.0 - this.mean[0]) / this.std[0];     // R\n                tensorData[1 * h * w + y * w + x] = (data[idx + 1] / 255.0 - this.mean[1]) / this.std[1]; // G\n                tensorData[2 * h * w + y * w + x] = (data[idx + 2] / 255.0 - this.mean[2]) / this.std[2]; // B\n            }\n        }\n        \n        return {\n            tensor: new ort.Tensor('float32', tensorData, [1, c, h, w]),\n            originalSize: [canvas.height, canvas.width]\n        };\n    }\n}","/**\n * OnnxOCR-based postprocessing functions\n * Pure JavaScript implementation\n */\n\n/**\n * DB (Differentiable Binarization) postprocessing for text detection\n */\nexport class DBPostProcessor {\n    constructor(options = {}) {\n        this.thresh = options.thresh || 0.3;\n        this.boxThresh = options.box_thresh || 0.6;\n        this.maxCandidates = options.max_candidates || 1000;\n        this.unclipRatio = options.unclip_ratio || 1.5;\n        this.minSize = options.min_size || 3;\n        this.scoreMode = options.score_mode || 'fast';\n    }\n\n    process(predictions, shapes) {\n        const pred = predictions[0];\n        const shape = shapes[0];\n        \n        // Get binary map\n        const binaryMap = this.threshold(pred);\n        \n        // Find contours\n        const contours = this.findContours(binaryMap);\n        \n        // Process each contour\n        const boxes = [];\n        const scores = [];\n        \n        for (const contour of contours) {\n            if (contour.length < 4) continue;\n            \n            // Get minimum area rectangle\n            const rect = this.getMinAreaRect(contour);\n            if (!rect) continue;\n            \n            // Calculate score\n            const score = this.boxScore(pred, rect);\n            if (score < this.boxThresh) continue;\n            \n            // Unclip the box\n            const box = this.unclip(rect);\n            if (!box) continue;\n            \n            // Rescale to original image size\n            const rescaledBox = this.rescaleBox(box, shape);\n            \n            // Filter by size\n            if (this.validateBox(rescaledBox)) {\n                boxes.push(rescaledBox);\n                scores.push(score);\n            }\n        }\n        \n        return { boxes, scores };\n    }\n\n    threshold(pred) {\n        const height = pred.length;\n        const width = pred[0].length;\n        const binary = [];\n        \n        for (let i = 0; i < height; i++) {\n            binary[i] = [];\n            for (let j = 0; j < width; j++) {\n                binary[i][j] = pred[i][j] > this.thresh ? 1 : 0;\n            }\n        }\n        \n        return binary;\n    }\n\n    findContours(binaryMap) {\n        const height = binaryMap.length;\n        const width = binaryMap[0].length;\n        const visited = Array(height).fill(null).map(() => Array(width).fill(false));\n        const contours = [];\n        \n        // Find connected components\n        for (let i = 0; i < height; i++) {\n            for (let j = 0; j < width; j++) {\n                if (binaryMap[i][j] === 1 && !visited[i][j]) {\n                    const contour = this.traceContour(binaryMap, visited, i, j);\n                    if (contour.length >= 4) {\n                        contours.push(contour);\n                    }\n                }\n            }\n        }\n        \n        return contours;\n    }\n\n    traceContour(binaryMap, visited, startY, startX) {\n        const height = binaryMap.length;\n        const width = binaryMap[0].length;\n        const contour = [];\n        const queue = [[startY, startX]];\n        const directions = [[-1, 0], [1, 0], [0, -1], [0, 1], [-1, -1], [-1, 1], [1, -1], [1, 1]];\n        \n        while (queue.length > 0) {\n            const [y, x] = queue.shift();\n            if (visited[y][x]) continue;\n            \n            visited[y][x] = true;\n            \n            // Check if it's a boundary point\n            let isBoundary = false;\n            for (const [dy, dx] of directions) {\n                const ny = y + dy;\n                const nx = x + dx;\n                if (ny < 0 || ny >= height || nx < 0 || nx >= width || binaryMap[ny][nx] === 0) {\n                    isBoundary = true;\n                    break;\n                }\n            }\n            \n            if (isBoundary) {\n                contour.push([x, y]);\n            }\n            \n            // Add neighbors to queue\n            for (const [dy, dx] of directions) {\n                const ny = y + dy;\n                const nx = x + dx;\n                if (ny >= 0 && ny < height && nx >= 0 && nx < width && \n                    binaryMap[ny][nx] === 1 && !visited[ny][nx]) {\n                    queue.push([ny, nx]);\n                }\n            }\n        }\n        \n        return contour;\n    }\n\n    getMinAreaRect(contour) {\n        if (contour.length < 4) return null;\n        \n        // Find convex hull\n        const hull = this.convexHull(contour);\n        if (hull.length < 4) return null;\n        \n        // Find minimum area rectangle\n        let minArea = Infinity;\n        let bestRect = null;\n        \n        for (let i = 0; i < hull.length; i++) {\n            const p1 = hull[i];\n            const p2 = hull[(i + 1) % hull.length];\n            \n            // Calculate edge vector\n            const edge = [p2[0] - p1[0], p2[1] - p1[1]];\n            const edgeLength = Math.sqrt(edge[0] * edge[0] + edge[1] * edge[1]);\n            if (edgeLength === 0) continue;\n            \n            edge[0] /= edgeLength;\n            edge[1] /= edgeLength;\n            \n            // Project all points onto this edge\n            let minProj = Infinity;\n            let maxProj = -Infinity;\n            let minPerpProj = Infinity;\n            let maxPerpProj = -Infinity;\n            \n            for (const point of hull) {\n                const proj = (point[0] - p1[0]) * edge[0] + (point[1] - p1[1]) * edge[1];\n                const perpProj = (point[0] - p1[0]) * (-edge[1]) + (point[1] - p1[1]) * edge[0];\n                \n                minProj = Math.min(minProj, proj);\n                maxProj = Math.max(maxProj, proj);\n                minPerpProj = Math.min(minPerpProj, perpProj);\n                maxPerpProj = Math.max(maxPerpProj, perpProj);\n            }\n            \n            const width = maxProj - minProj;\n            const height = maxPerpProj - minPerpProj;\n            const area = width * height;\n            \n            if (area < minArea) {\n                minArea = area;\n                \n                // Calculate rectangle corners\n                const corner1 = [\n                    p1[0] + minProj * edge[0] + minPerpProj * (-edge[1]),\n                    p1[1] + minProj * edge[1] + minPerpProj * edge[0]\n                ];\n                const corner2 = [\n                    p1[0] + maxProj * edge[0] + minPerpProj * (-edge[1]),\n                    p1[1] + maxProj * edge[1] + minPerpProj * edge[0]\n                ];\n                const corner3 = [\n                    p1[0] + maxProj * edge[0] + maxPerpProj * (-edge[1]),\n                    p1[1] + maxProj * edge[1] + maxPerpProj * edge[0]\n                ];\n                const corner4 = [\n                    p1[0] + minProj * edge[0] + maxPerpProj * (-edge[1]),\n                    p1[1] + minProj * edge[1] + maxPerpProj * edge[0]\n                ];\n                \n                bestRect = [corner1, corner2, corner3, corner4];\n            }\n        }\n        \n        return bestRect;\n    }\n\n    convexHull(points) {\n        // Graham scan algorithm\n        if (points.length < 3) return points;\n        \n        // Find the bottom-most point (and left-most if tied)\n        let start = 0;\n        for (let i = 1; i < points.length; i++) {\n            if (points[i][1] < points[start][1] || \n                (points[i][1] === points[start][1] && points[i][0] < points[start][0])) {\n                start = i;\n            }\n        }\n        \n        // Sort points by polar angle with respect to start point\n        const sorted = points.slice();\n        const startPoint = sorted.splice(start, 1)[0];\n        \n        sorted.sort((a, b) => {\n            const angleA = Math.atan2(a[1] - startPoint[1], a[0] - startPoint[0]);\n            const angleB = Math.atan2(b[1] - startPoint[1], b[0] - startPoint[0]);\n            if (angleA !== angleB) return angleA - angleB;\n            \n            // If angles are equal, sort by distance\n            const distA = (a[0] - startPoint[0]) * (a[0] - startPoint[0]) + \n                         (a[1] - startPoint[1]) * (a[1] - startPoint[1]);\n            const distB = (b[0] - startPoint[0]) * (b[0] - startPoint[0]) + \n                         (b[1] - startPoint[1]) * (b[1] - startPoint[1]);\n            return distA - distB;\n        });\n        \n        // Build hull\n        const hull = [startPoint];\n        for (const point of sorted) {\n            while (hull.length >= 2) {\n                const p1 = hull[hull.length - 2];\n                const p2 = hull[hull.length - 1];\n                const cross = (p2[0] - p1[0]) * (point[1] - p1[1]) - \n                            (p2[1] - p1[1]) * (point[0] - p1[0]);\n                if (cross <= 0) {\n                    hull.pop();\n                } else {\n                    break;\n                }\n            }\n            hull.push(point);\n        }\n        \n        return hull;\n    }\n\n    boxScore(pred, box) {\n        // Fast box score calculation\n        const xmin = Math.min(...box.map(p => p[0]));\n        const xmax = Math.max(...box.map(p => p[0]));\n        const ymin = Math.min(...box.map(p => p[1]));\n        const ymax = Math.max(...box.map(p => p[1]));\n        \n        let sum = 0;\n        let count = 0;\n        \n        for (let y = Math.floor(ymin); y <= Math.ceil(ymax); y++) {\n            for (let x = Math.floor(xmin); x <= Math.ceil(xmax); x++) {\n                if (y >= 0 && y < pred.length && x >= 0 && x < pred[0].length) {\n                    if (this.pointInPolygon([x, y], box)) {\n                        sum += pred[y][x];\n                        count++;\n                    }\n                }\n            }\n        }\n        \n        return count > 0 ? sum / count : 0;\n    }\n\n    pointInPolygon(point, polygon) {\n        let inside = false;\n        const x = point[0];\n        const y = point[1];\n        \n        for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {\n            const xi = polygon[i][0];\n            const yi = polygon[i][1];\n            const xj = polygon[j][0];\n            const yj = polygon[j][1];\n            \n            const intersect = ((yi > y) !== (yj > y)) &&\n                            (x < (xj - xi) * (y - yi) / (yj - yi) + xi);\n            if (intersect) inside = !inside;\n        }\n        \n        return inside;\n    }\n\n    unclip(box) {\n        // Calculate perimeter\n        let perimeter = 0;\n        for (let i = 0; i < box.length; i++) {\n            const j = (i + 1) % box.length;\n            const dx = box[j][0] - box[i][0];\n            const dy = box[j][1] - box[i][1];\n            perimeter += Math.sqrt(dx * dx + dy * dy);\n        }\n        \n        // Calculate area\n        let area = 0;\n        for (let i = 0; i < box.length; i++) {\n            const j = (i + 1) % box.length;\n            area += box[i][0] * box[j][1] - box[j][0] * box[i][1];\n        }\n        area = Math.abs(area) / 2;\n        \n        // Calculate distance to expand\n        const distance = area * this.unclipRatio / perimeter;\n        \n        // Expand box\n        const expandedBox = [];\n        for (let i = 0; i < box.length; i++) {\n            const prev = box[(i - 1 + box.length) % box.length];\n            const curr = box[i];\n            const next = box[(i + 1) % box.length];\n            \n            // Calculate normal vector\n            const v1 = [prev[0] - curr[0], prev[1] - curr[1]];\n            const v2 = [next[0] - curr[0], next[1] - curr[1]];\n            \n            const len1 = Math.sqrt(v1[0] * v1[0] + v1[1] * v1[1]);\n            const len2 = Math.sqrt(v2[0] * v2[0] + v2[1] * v2[1]);\n            \n            if (len1 > 0) {\n                v1[0] /= len1;\n                v1[1] /= len1;\n            }\n            if (len2 > 0) {\n                v2[0] /= len2;\n                v2[1] /= len2;\n            }\n            \n            const bisector = [v1[0] + v2[0], v1[1] + v2[1]];\n            const bisectorLen = Math.sqrt(bisector[0] * bisector[0] + bisector[1] * bisector[1]);\n            \n            if (bisectorLen > 0) {\n                bisector[0] /= bisectorLen;\n                bisector[1] /= bisectorLen;\n                \n                expandedBox.push([\n                    curr[0] - bisector[0] * distance,\n                    curr[1] - bisector[1] * distance\n                ]);\n            } else {\n                expandedBox.push(curr);\n            }\n        }\n        \n        return expandedBox;\n    }\n\n    rescaleBox(box, shape) {\n        const [origH, origW, ratioH, ratioW] = shape;\n        \n        return box.map(point => [\n            point[0] / ratioW,\n            point[1] / ratioH\n        ]);\n    }\n\n    validateBox(box) {\n        // Calculate box dimensions\n        const width = Math.max(\n            this.distance(box[0], box[1]),\n            this.distance(box[2], box[3])\n        );\n        const height = Math.max(\n            this.distance(box[0], box[3]),\n            this.distance(box[1], box[2])\n        );\n        \n        return width >= this.minSize && height >= this.minSize;\n    }\n\n    distance(p1, p2) {\n        const dx = p2[0] - p1[0];\n        const dy = p2[1] - p1[1];\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n}\n\n/**\n * Classification postprocessing\n */\nexport class ClassificationPostProcessor {\n    constructor(options = {}) {\n        this.labelList = options.label_list || ['0', '180'];\n        this.clsThresh = options.cls_thresh || 0.9;\n    }\n\n    process(predictions) {\n        const results = [];\n        const preds = predictions[0];\n        \n        for (let i = 0; i < preds.length; i++) {\n            const pred = preds[i];\n            const maxIdx = pred.indexOf(Math.max(...pred));\n            const score = pred[maxIdx];\n            const label = this.labelList[maxIdx];\n            \n            results.push({\n                label,\n                score,\n                shouldRotate: label === '180' && score > this.clsThresh\n            });\n        }\n        \n        return results;\n    }\n}\n\n/**\n * CTC (Connectionist Temporal Classification) decoder for text recognition\n */\nexport class CTCDecoder {\n    constructor(characterDict) {\n        this.characterDict = characterDict;\n        this.blankIdx = characterDict.length; // Blank token is usually at the end\n    }\n\n    decode(predictions, method = 'greedy') {\n        if (method === 'greedy') {\n            return this.greedyDecode(predictions);\n        } else if (method === 'beam_search') {\n            return this.beamSearchDecode(predictions);\n        }\n        throw new Error(`Unknown decode method: ${method}`);\n    }\n\n    greedyDecode(predictions) {\n        const results = [];\n        \n        for (const pred of predictions) {\n            const indices = [];\n            let lastIdx = -1;\n            \n            // Get max indices\n            for (let t = 0; t < pred.length; t++) {\n                const maxIdx = pred[t].indexOf(Math.max(...pred[t]));\n                \n                // Skip blanks and repeated characters\n                if (maxIdx !== this.blankIdx && maxIdx !== lastIdx) {\n                    indices.push(maxIdx);\n                }\n                lastIdx = maxIdx;\n            }\n            \n            // Convert indices to text\n            const text = indices.map(idx => this.characterDict[idx]).join('');\n            const confidence = this.calculateConfidence(pred, indices);\n            \n            results.push({ text, confidence });\n        }\n        \n        return results;\n    }\n\n    beamSearchDecode(predictions, beamWidth = 5) {\n        const results = [];\n        \n        for (const pred of predictions) {\n            const beams = this.beamSearch(pred, beamWidth);\n            const bestBeam = beams[0];\n            \n            results.push({\n                text: bestBeam.text,\n                confidence: bestBeam.score\n            });\n        }\n        \n        return results;\n    }\n\n    beamSearch(pred, beamWidth) {\n        let beams = [{ text: '', score: 1.0, lastIdx: -1 }];\n        \n        for (let t = 0; t < pred.length; t++) {\n            const newBeams = [];\n            \n            for (const beam of beams) {\n                // Get top k indices\n                const probs = pred[t];\n                const topK = this.getTopK(probs, beamWidth);\n                \n                for (const [idx, prob] of topK) {\n                    if (idx === this.blankIdx) {\n                        // Blank token - keep current beam\n                        newBeams.push({\n                            text: beam.text,\n                            score: beam.score * prob,\n                            lastIdx: idx\n                        });\n                    } else if (idx !== beam.lastIdx) {\n                        // New character\n                        newBeams.push({\n                            text: beam.text + this.characterDict[idx],\n                            score: beam.score * prob,\n                            lastIdx: idx\n                        });\n                    } else {\n                        // Repeated character - keep current beam\n                        newBeams.push({\n                            text: beam.text,\n                            score: beam.score * prob,\n                            lastIdx: idx\n                        });\n                    }\n                }\n            }\n            \n            // Keep top beams\n            newBeams.sort((a, b) => b.score - a.score);\n            beams = newBeams.slice(0, beamWidth);\n        }\n        \n        return beams;\n    }\n\n    getTopK(arr, k) {\n        const indexed = arr.map((val, idx) => [idx, val]);\n        indexed.sort((a, b) => b[1] - a[1]);\n        return indexed.slice(0, k);\n    }\n\n    calculateConfidence(pred, indices) {\n        if (indices.length === 0) return 0;\n        \n        let totalConf = 0;\n        let t = 0;\n        \n        for (const idx of indices) {\n            // Find the time step where this character appears\n            while (t < pred.length) {\n                const maxIdx = pred[t].indexOf(Math.max(...pred[t]));\n                if (maxIdx === idx) {\n                    totalConf += pred[t][idx];\n                    t++;\n                    break;\n                }\n                t++;\n            }\n        }\n        \n        return totalConf / indices.length;\n    }\n}\n\n/**\n * Sort detected text boxes from top to bottom, left to right\n */\nexport function sortBoxes(boxes) {\n    if (!boxes || boxes.length === 0) return [];\n    \n    // Calculate center points\n    const boxesWithCenter = boxes.map((box, index) => {\n        const centerX = box.reduce((sum, p) => sum + p[0], 0) / box.length;\n        const centerY = box.reduce((sum, p) => sum + p[1], 0) / box.length;\n        return { box, index, centerX, centerY };\n    });\n    \n    // Sort by y coordinate first, then by x coordinate\n    boxesWithCenter.sort((a, b) => {\n        // If boxes are on the same line (y difference < 10 pixels)\n        if (Math.abs(a.centerY - b.centerY) < 10) {\n            return a.centerX - b.centerX;\n        }\n        return a.centerY - b.centerY;\n    });\n    \n    return boxesWithCenter.map(item => item.box);\n}","/**\n * PP-OCRv5 ONNX Engine with exact OnnxOCR preprocessing/postprocessing\n * Includes CLS (angle classification), DET (text detection), and REC (text recognition)\n */\n\nimport * as ort from 'onnxruntime-web';\nimport { \n    DetectionPreprocessor, \n    ClassificationPreprocessor, \n    RecognitionPreprocessor,\n    TextRegionExtractor \n} from './onnx-ocr-preprocessing.js';\nimport { \n    DBPostProcessor, \n    ClassificationPostProcessor, \n    CTCDecoder, \n    sortBoxes \n} from './onnx-ocr-postprocessing.js';\nimport { ocrCache } from './ocr-cache-manager.js';\n\n// Configure ONNX Runtime\nconst isGitHubPages = window.location.hostname.includes('github.io');\nconst basePath = isGitHubPages ? '/client-ocr-app' : '';\nconst wasmPath = `${basePath}/assets/`;\nort.env.wasm.wasmPaths = wasmPath;\nort.env.wasm.numThreads = 1;\n\nexport class PPOCRv5OnnxEngine {\n    constructor(options = {}) {\n        this.modelName = options.modelName || 'PP-OCRv5';\n        this.useAngleCls = options.useAngleCls !== false;\n        this.useCache = options.useCache !== false;\n        \n        // Model paths based on model name\n        const modelBasePath = `${basePath}/models/`;\n        this.modelPaths = {\n            'PP-OCRv5': {\n                det: modelBasePath + 'PP-OCRv5/det/det.onnx',\n                cls: modelBasePath + 'PP-OCRv5/cls/cls.onnx',\n                rec: modelBasePath + 'PP-OCRv5/rec/rec.onnx',\n                dict: modelBasePath + 'PP-OCRv5/ppocrv5_dict.txt'\n            },\n            'PP-OCRv5_mobile': {\n                det: modelBasePath + 'PP-OCRv5_mobile_det_infer.onnx',\n                cls: modelBasePath + 'PP-OCRv5/cls/cls.onnx',\n                rec: modelBasePath + 'PP-OCRv5_mobile_rec_infer.onnx',\n                dict: modelBasePath + 'ppocrv5_dict.txt'\n            },\n            'PP-OCRv4': {\n                det: modelBasePath + 'PP-OCRv4/det/det.onnx',\n                cls: modelBasePath + 'PP-OCRv4/cls/cls.onnx',\n                rec: modelBasePath + 'PP-OCRv4/rec/rec.onnx',\n                dict: modelBasePath + 'PP-OCRv4/ppocr_keys_v1.txt'\n            },\n            'PP-OCRv4_mobile': {\n                det: modelBasePath + 'PP-OCRv4/det/det.onnx',\n                cls: modelBasePath + 'PP-OCRv4/cls/cls.onnx',\n                rec: modelBasePath + 'en_PP-OCRv4_mobile_rec_infer.onnx',\n                dict: modelBasePath + 'en_dict.txt'\n            },\n            'ch_ppocr_server_v2.0': {\n                det: modelBasePath + 'ch_ppocr_server_v2.0/det/det.onnx',\n                cls: modelBasePath + 'ch_ppocr_server_v2.0/cls/cls.onnx',\n                rec: null, // Server v2.0 doesn't have rec model in the directory\n                dict: modelBasePath + 'ch_ppocr_server_v2.0/ppocr_keys_v1.txt'\n            }\n        };\n        \n        // OnnxOCR parameters\n        this.detParams = {\n            det_limit_side_len: options.detLimitSideLen || 960,\n            det_limit_type: options.detLimitType || 'min',\n            det_db_thresh: options.detDbThresh || 0.3,\n            det_db_box_thresh: options.detDbBoxThresh || 0.6,\n            det_db_unclip_ratio: options.detDbUnclipRatio || 1.7,\n            det_db_score_mode: options.detDbScoreMode || 'fast'\n        };\n        \n        this.clsParams = {\n            cls_image_shape: [3, 48, 192],\n            cls_thresh: options.clsThresh || 0.9,\n            label_list: ['0', '180']\n        };\n        \n        this.recParams = {\n            rec_image_shape: [3, 48, 320],\n            rec_algorithm: 'SVTR_LCNet'\n        };\n        \n        // Preprocessors\n        this.detPreprocessor = new DetectionPreprocessor(this.detParams);\n        this.clsPreprocessor = new ClassificationPreprocessor(this.clsParams);\n        this.recPreprocessor = new RecognitionPreprocessor(this.recParams);\n        \n        // Postprocessors\n        this.detPostprocessor = new DBPostProcessor({\n            thresh: this.detParams.det_db_thresh,\n            box_thresh: this.detParams.det_db_box_thresh,\n            unclip_ratio: this.detParams.det_db_unclip_ratio,\n            score_mode: this.detParams.det_db_score_mode\n        });\n        this.clsPostprocessor = new ClassificationPostProcessor(this.clsParams);\n        \n        // Sessions\n        this.detSession = null;\n        this.clsSession = null;\n        this.recSession = null;\n        \n        // Character dictionary\n        this.characterDict = null;\n        this.ctcDecoder = null;\n        \n        this.initialized = false;\n    }\n    \n    async initialize(progressCallback = null) {\n        if (this.initialized) return;\n        \n        try {\n            const paths = this.modelPaths[this.modelName];\n            if (!paths) {\n                throw new Error(`Unknown model: ${this.modelName}`);\n            }\n            \n            // Load character dictionary\n            progressCallback?.('Loading character dictionary...');\n            await this.loadCharacterDict(paths.dict);\n            \n            // Load detection model\n            progressCallback?.('Loading detection model...');\n            this.detSession = await ort.InferenceSession.create(paths.det, {\n                executionProviders: ['wasm'],\n                graphOptimizationLevel: 'all'\n            });\n            \n            // Load classification model if enabled\n            if (this.useAngleCls) {\n                progressCallback?.('Loading angle classification model...');\n                this.clsSession = await ort.InferenceSession.create(paths.cls, {\n                    executionProviders: ['wasm'],\n                    graphOptimizationLevel: 'all'\n                });\n            }\n            \n            // Load recognition model if available\n            if (paths.rec) {\n                progressCallback?.('Loading recognition model...');\n                this.recSession = await ort.InferenceSession.create(paths.rec, {\n                    executionProviders: ['wasm'],\n                    graphOptimizationLevel: 'all'\n                });\n            } else if (this.modelName === 'ch_ppocr_server_v2.0') {\n                // Use PP-OCRv4 rec model as fallback for server v2.0\n                const fallbackRecPath = `${basePath}/models/PP-OCRv4/rec/rec.onnx`;\n                progressCallback?.('Loading recognition model (fallback)...');\n                this.recSession = await ort.InferenceSession.create(fallbackRecPath, {\n                    executionProviders: ['wasm'],\n                    graphOptimizationLevel: 'all'\n                });\n            }\n            \n            this.initialized = true;\n            progressCallback?.('Initialization complete!');\n        } catch (error) {\n            console.error('Failed to initialize PP-OCRv5 ONNX engine:', error);\n            throw error;\n        }\n    }\n    \n    async loadCharacterDict(dictPath) {\n        try {\n            const response = await fetch(dictPath);\n            const text = await response.text();\n            this.characterDict = text.split('\\n').filter(char => char.length > 0);\n            this.ctcDecoder = new CTCDecoder(this.characterDict);\n        } catch (error) {\n            console.error('Failed to load character dictionary:', error);\n            throw error;\n        }\n    }\n    \n    async process(input, progressCallback = null) {\n        if (!this.initialized) {\n            await this.initialize(progressCallback);\n        }\n        \n        // Check cache if enabled\n        if (this.useCache) {\n            const cached = await this.checkCache(input);\n            if (cached) {\n                progressCallback?.('Using cached result');\n                return cached;\n            }\n        }\n        \n        // Convert input to canvas\n        const canvas = await this.inputToCanvas(input);\n        \n        // Text Detection\n        progressCallback?.('Detecting text regions...');\n        const detectionResult = await this.detectText(canvas);\n        \n        if (!detectionResult || detectionResult.boxes.length === 0) {\n            return { text: '', boxes: [], lines: [] };\n        }\n        \n        // Sort boxes from top to bottom, left to right\n        const sortedBoxes = sortBoxes(detectionResult.boxes);\n        \n        // Process each text region\n        const textResults = [];\n        for (let i = 0; i < sortedBoxes.length; i++) {\n            progressCallback?.(`Processing region ${i + 1}/${sortedBoxes.length}...`);\n            \n            const box = sortedBoxes[i];\n            \n            // Extract text region\n            const regionCanvas = TextRegionExtractor.extractRegion(canvas, box);\n            \n            // Angle classification\n            let angle = 0;\n            if (this.useAngleCls && this.clsSession) {\n                const clsResult = await this.classifyAngle(regionCanvas);\n                if (clsResult.shouldRotate) {\n                    // Rotate 180 degrees\n                    const rotatedCanvas = this.rotateCanvas(regionCanvas, 180);\n                    regionCanvas.width = rotatedCanvas.width;\n                    regionCanvas.height = rotatedCanvas.height;\n                    regionCanvas.getContext('2d').drawImage(rotatedCanvas, 0, 0);\n                    angle = 180;\n                }\n            }\n            \n            // Text recognition\n            const recResult = await this.recognizeText(regionCanvas);\n            \n            textResults.push({\n                box,\n                text: recResult.text,\n                confidence: recResult.confidence,\n                angle\n            });\n        }\n        \n        // Combine results\n        const fullText = textResults.map(r => r.text).join('\\n');\n        const result = {\n            text: fullText,\n            boxes: sortedBoxes,\n            lines: textResults,\n            modelName: this.modelName\n        };\n        \n        // Cache result if enabled\n        if (this.useCache) {\n            await this.cacheResult(input, result);\n        }\n        \n        return result;\n    }\n    \n    async detectText(canvas) {\n        // Preprocess image\n        const preprocessed = await this.detPreprocessor.preprocess(canvas);\n        \n        // Create tensor\n        const inputTensor = new ort.Tensor('float32', preprocessed.tensor, [1, 3, preprocessed.resizedShape[0], preprocessed.resizedShape[1]]);\n        \n        // Run inference\n        const feeds = { x: inputTensor };\n        const results = await this.detSession.run(feeds);\n        \n        // Get output tensor\n        const output = results.sigmoid_0 || results.save_infer_model_scale_0_tmp_1 || Object.values(results)[0];\n        \n        // Reshape output to [height, width]\n        const outputData = output.data;\n        const [, , height, width] = output.dims;\n        const predMap = [];\n        \n        for (let h = 0; h < height; h++) {\n            predMap[h] = [];\n            for (let w = 0; w < width; w++) {\n                predMap[h][w] = outputData[h * width + w];\n            }\n        }\n        \n        // Postprocess to get boxes\n        const postResult = this.detPostprocessor.process([predMap], [preprocessed.originalShape.concat(preprocessed.ratio)]);\n        \n        return postResult;\n    }\n    \n    async classifyAngle(canvas) {\n        // Preprocess image\n        const preprocessed = await this.clsPreprocessor.preprocess(canvas);\n        \n        // Create tensor\n        const inputTensor = new ort.Tensor('float32', preprocessed, [1, ...this.clsParams.cls_image_shape]);\n        \n        // Run inference\n        const feeds = { x: inputTensor };\n        const results = await this.clsSession.run(feeds);\n        \n        // Get output\n        const output = results.save_infer_model_scale_0_tmp_1 || Object.values(results)[0];\n        const outputData = Array.from(output.data);\n        \n        // Postprocess\n        const clsResult = this.clsPostprocessor.process([outputData]);\n        \n        return clsResult[0];\n    }\n    \n    async recognizeText(canvas) {\n        if (!this.recSession) {\n            return { text: '', confidence: 0 };\n        }\n        \n        // Calculate max width-height ratio\n        const maxWhRatio = canvas.width / canvas.height;\n        \n        // Preprocess image\n        const preprocessed = await this.recPreprocessor.preprocess(canvas, maxWhRatio);\n        \n        // Create tensor\n        const inputTensor = new ort.Tensor('float32', preprocessed.tensor, preprocessed.shape);\n        \n        // Run inference\n        const feeds = { x: inputTensor };\n        const results = await this.recSession.run(feeds);\n        \n        // Get output\n        const output = results.save_infer_model_scale_0_tmp_1 || Object.values(results)[0];\n        \n        // Reshape output\n        const [, timeSteps, vocabSize] = output.dims;\n        const outputData = output.data;\n        const predictions = [];\n        \n        for (let t = 0; t < timeSteps; t++) {\n            const probs = [];\n            for (let v = 0; v < vocabSize; v++) {\n                probs.push(outputData[t * vocabSize + v]);\n            }\n            predictions.push(probs);\n        }\n        \n        // Decode using CTC\n        const decoded = this.ctcDecoder.decode([predictions], 'greedy');\n        \n        return decoded[0];\n    }\n    \n    async inputToCanvas(input) {\n        if (input instanceof HTMLCanvasElement) {\n            return input;\n        }\n        \n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        \n        if (input instanceof File || input instanceof Blob) {\n            const img = new Image();\n            const url = URL.createObjectURL(input);\n            \n            return new Promise((resolve, reject) => {\n                img.onload = () => {\n                    canvas.width = img.width;\n                    canvas.height = img.height;\n                    ctx.drawImage(img, 0, 0);\n                    URL.revokeObjectURL(url);\n                    resolve(canvas);\n                };\n                img.onerror = reject;\n                img.src = url;\n            });\n        } else if (typeof input === 'string') {\n            // URL or base64\n            const img = new Image();\n            img.crossOrigin = 'anonymous';\n            \n            return new Promise((resolve, reject) => {\n                img.onload = () => {\n                    canvas.width = img.width;\n                    canvas.height = img.height;\n                    ctx.drawImage(img, 0, 0);\n                    resolve(canvas);\n                };\n                img.onerror = reject;\n                img.src = input;\n            });\n        }\n        \n        throw new Error('Unsupported input type');\n    }\n    \n    rotateCanvas(canvas, degrees) {\n        const radians = degrees * Math.PI / 180;\n        const rotatedCanvas = document.createElement('canvas');\n        const ctx = rotatedCanvas.getContext('2d');\n        \n        if (degrees === 180) {\n            rotatedCanvas.width = canvas.width;\n            rotatedCanvas.height = canvas.height;\n            ctx.translate(canvas.width, canvas.height);\n            ctx.rotate(radians);\n            ctx.drawImage(canvas, 0, 0);\n        } else if (degrees === 90 || degrees === -270) {\n            rotatedCanvas.width = canvas.height;\n            rotatedCanvas.height = canvas.width;\n            ctx.translate(canvas.height, 0);\n            ctx.rotate(radians);\n            ctx.drawImage(canvas, 0, 0);\n        } else if (degrees === -90 || degrees === 270) {\n            rotatedCanvas.width = canvas.height;\n            rotatedCanvas.height = canvas.width;\n            ctx.translate(0, canvas.width);\n            ctx.rotate(radians);\n            ctx.drawImage(canvas, 0, 0);\n        }\n        \n        return rotatedCanvas;\n    }\n    \n    async checkCache(input) {\n        if (!this.useCache) return null;\n        \n        const cacheKey = await this.generateCacheKey(input);\n        return ocrCache.get(cacheKey, 'ppocr-v5-onnx', this.modelName);\n    }\n    \n    async cacheResult(input, result) {\n        if (!this.useCache) return;\n        \n        const cacheKey = await this.generateCacheKey(input);\n        ocrCache.set(cacheKey, 'ppocr-v5-onnx', this.modelName, result);\n    }\n    \n    async generateCacheKey(input) {\n        if (input instanceof File) {\n            return await this.fileToBase64(input);\n        } else if (typeof input === 'string') {\n            return input;\n        } else if (input instanceof HTMLCanvasElement) {\n            return input.toDataURL();\n        }\n        return JSON.stringify(input);\n    }\n    \n    async fileToBase64(file) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onload = e => resolve(e.target.result);\n            reader.onerror = reject;\n            reader.readAsDataURL(file);\n        });\n    }\n    \n    getCacheStats() {\n        return ocrCache.getStats();\n    }\n    \n    clearCache() {\n        ocrCache.clear();\n    }\n}\n\n// Export singleton instance for backward compatibility\nexport const ppOCRv5OnnxEngine = new PPOCRv5OnnxEngine();","/**\n * Advanced OnnxOCR functionalities\n * Includes multi-language support, batch processing, and advanced options\n */\n\nimport { PPOCRv5OnnxEngine } from './ppocr-v5-onnx-engine.js';\nimport { ocrCache } from './ocr-cache-manager.js';\nimport { \n    drawOCRResults, \n    createOCRVisualization, \n    sortTextRegions,\n    groupTextIntoLines,\n    formatOCRResults \n} from './ocr-utils.js';\n\n/**\n * Multi-language OCR engine supporting multiple languages\n */\nexport class MultiLanguageOCREngine extends PPOCRv5OnnxEngine {\n    constructor(options = {}) {\n        super(options);\n        \n        // Language-specific model configurations\n        this.languageModels = {\n            'en': {\n                modelName: 'PP-OCRv4_mobile',\n                dict: 'models/en_dict.txt'\n            },\n            'ch': {\n                modelName: 'PP-OCRv5',\n                dict: 'models/ppocrv5_dict.txt'\n            },\n            'japan': {\n                modelName: 'PP-OCRv4',\n                dict: 'models/japan_dict.txt'\n            },\n            'korean': {\n                modelName: 'PP-OCRv4',\n                dict: 'models/korean_dict.txt'\n            },\n            'multi': {\n                modelName: 'PP-OCRv5',\n                dict: 'models/multi_dict.txt'\n            }\n        };\n        \n        this.currentLanguage = options.language || 'en';\n    }\n    \n    async setLanguage(language) {\n        if (!this.languageModels[language]) {\n            throw new Error(`Unsupported language: ${language}`);\n        }\n        \n        this.currentLanguage = language;\n        const config = this.languageModels[language];\n        this.modelName = config.modelName;\n        \n        // Reset initialization to reload models\n        this.initialized = false;\n        await this.initialize();\n    }\n    \n    getSupportedLanguages() {\n        return Object.keys(this.languageModels);\n    }\n}\n\n/**\n * Batch OCR processor with parallel processing capabilities\n */\nexport class BatchOCRProcessor {\n    constructor(engine, options = {}) {\n        this.engine = engine;\n        this.concurrency = options.concurrency || 2;\n        this.batchSize = options.batchSize || 5;\n        this.progressCallback = options.progressCallback;\n    }\n    \n    async processBatch(files, options = {}) {\n        const results = [];\n        const totalFiles = files.length;\n        let processedCount = 0;\n        \n        // Process files in batches\n        for (let i = 0; i < totalFiles; i += this.batchSize) {\n            const batch = files.slice(i, Math.min(i + this.batchSize, totalFiles));\n            \n            // Process batch with concurrency control\n            const batchPromises = batch.map(async (file, index) => {\n                try {\n                    const globalIndex = i + index;\n                    this.progressCallback?.({\n                        current: processedCount,\n                        total: totalFiles,\n                        processing: file.name,\n                        phase: 'processing'\n                    });\n                    \n                    const result = await this.engine.process(file);\n                    processedCount++;\n                    \n                    return {\n                        file: file.name,\n                        index: globalIndex,\n                        result,\n                        success: true\n                    };\n                } catch (error) {\n                    processedCount++;\n                    return {\n                        file: file.name,\n                        index: globalIndex,\n                        error: error.message,\n                        success: false\n                    };\n                }\n            });\n            \n            // Wait for batch to complete\n            const batchResults = await Promise.all(batchPromises);\n            results.push(...batchResults);\n            \n            this.progressCallback?.({\n                current: processedCount,\n                total: totalFiles,\n                phase: 'batch_complete',\n                batchNumber: Math.floor(i / this.batchSize) + 1\n            });\n        }\n        \n        return results;\n    }\n    \n    async exportResults(results, format = 'json') {\n        switch (format) {\n            case 'json':\n                return JSON.stringify(results, null, 2);\n                \n            case 'csv':\n                const headers = ['File', 'Success', 'Text', 'Confidence', 'Error'];\n                const rows = [headers.join(',')];\n                \n                results.forEach(result => {\n                    if (result.success) {\n                        const text = result.result.text.replace(/\"/g, '\"\"').replace(/\\n/g, ' ');\n                        const confidence = result.result.lines\n                            ? result.result.lines.reduce((sum, line) => sum + line.confidence, 0) / result.result.lines.length\n                            : 0;\n                        rows.push(`\"${result.file}\",\"true\",\"${text}\",\"${confidence.toFixed(3)}\",\"\"`);\n                    } else {\n                        rows.push(`\"${result.file}\",\"false\",\"\",\"\",\"${result.error}\"`);\n                    }\n                });\n                \n                return rows.join('\\n');\n                \n            case 'xlsx':\n                // For Excel export, return structured data that can be converted client-side\n                return {\n                    headers: ['File', 'Success', 'Text', 'Confidence', 'Error'],\n                    data: results.map(result => [\n                        result.file,\n                        result.success,\n                        result.success ? result.result.text : '',\n                        result.success && result.result.lines \n                            ? (result.result.lines.reduce((sum, line) => sum + line.confidence, 0) / result.result.lines.length).toFixed(3)\n                            : '',\n                        result.error || ''\n                    ])\n                };\n                \n            default:\n                throw new Error(`Unsupported export format: ${format}`);\n        }\n    }\n}\n\n/**\n * Advanced OCR options and configurations\n */\nexport class AdvancedOCROptions {\n    static getPresets() {\n        return {\n            'high_accuracy': {\n                detLimitSideLen: 1920,\n                detDbThresh: 0.2,\n                detDbBoxThresh: 0.5,\n                detDbUnclipRatio: 2.0,\n                dropScore: 0.3,\n                useAngleCls: true\n            },\n            'fast_processing': {\n                detLimitSideLen: 640,\n                detDbThresh: 0.4,\n                detDbBoxThresh: 0.7,\n                detDbUnclipRatio: 1.5,\n                dropScore: 0.6,\n                useAngleCls: false\n            },\n            'balanced': {\n                detLimitSideLen: 960,\n                detDbThresh: 0.3,\n                detDbBoxThresh: 0.6,\n                detDbUnclipRatio: 1.7,\n                dropScore: 0.5,\n                useAngleCls: true\n            },\n            'handwritten': {\n                detLimitSideLen: 1280,\n                detDbThresh: 0.15,\n                detDbBoxThresh: 0.4,\n                detDbUnclipRatio: 2.5,\n                dropScore: 0.3,\n                useAngleCls: true\n            },\n            'low_quality': {\n                detLimitSideLen: 1440,\n                detDbThresh: 0.1,\n                detDbBoxThresh: 0.3,\n                detDbUnclipRatio: 3.0,\n                dropScore: 0.2,\n                useAngleCls: true\n            }\n        };\n    }\n    \n    static mergeWithPreset(presetName, customOptions = {}) {\n        const presets = this.getPresets();\n        const preset = presets[presetName] || presets.balanced;\n        return { ...preset, ...customOptions };\n    }\n}\n\n/**\n * OCR result analyzer for extracting structured information\n */\nexport class OCRResultAnalyzer {\n    constructor() {\n        // Common patterns for structured data extraction\n        this.patterns = {\n            email: /[\\w.-]+@[\\w.-]+\\.\\w+/g,\n            phone: /[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{4,6}/g,\n            date: /(\\d{1,2}[-/]\\d{1,2}[-/]\\d{2,4})|(\\d{4}[-/]\\d{1,2}[-/]\\d{1,2})/g,\n            url: /https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\+.~#?&//=]*)/g,\n            amount: /[$]\\s*\\d+(?:,\\d{3})*(?:\\.\\d{2})?/g,\n            percentage: /\\d+\\.?\\d*\\s*%/g,\n            time: /\\d{1,2}:\\d{2}(?::\\d{2})?(?:\\s*[AP]M)?/gi\n        };\n    }\n    \n    analyze(ocrResult) {\n        const text = ocrResult.text || '';\n        const analysis = {\n            totalWords: this.countWords(text),\n            totalLines: ocrResult.lines ? ocrResult.lines.length : 0,\n            averageConfidence: this.calculateAverageConfidence(ocrResult),\n            extractedData: this.extractStructuredData(text),\n            layout: this.analyzeLayout(ocrResult),\n            quality: this.assessQuality(ocrResult)\n        };\n        \n        return analysis;\n    }\n    \n    countWords(text) {\n        return text.trim().split(/\\s+/).filter(word => word.length > 0).length;\n    }\n    \n    calculateAverageConfidence(ocrResult) {\n        if (!ocrResult.lines || ocrResult.lines.length === 0) return 0;\n        \n        const totalConfidence = ocrResult.lines.reduce((sum, line) => sum + line.confidence, 0);\n        return totalConfidence / ocrResult.lines.length;\n    }\n    \n    extractStructuredData(text) {\n        const extracted = {};\n        \n        for (const [key, pattern] of Object.entries(this.patterns)) {\n            const matches = text.match(pattern);\n            if (matches && matches.length > 0) {\n                extracted[key] = [...new Set(matches)]; // Remove duplicates\n            }\n        }\n        \n        return extracted;\n    }\n    \n    analyzeLayout(ocrResult) {\n        if (!ocrResult.boxes || ocrResult.boxes.length === 0) {\n            return { type: 'unknown', columns: 0, rows: 0 };\n        }\n        \n        // Group text regions into lines\n        const lines = groupTextIntoLines(ocrResult.lines || []);\n        \n        // Detect columns by analyzing x-coordinates\n        const xCoordinates = ocrResult.boxes.map(box => {\n            const minX = Math.min(...box.map(p => p[0]));\n            const maxX = Math.max(...box.map(p => p[0]));\n            return { min: minX, max: maxX, center: (minX + maxX) / 2 };\n        });\n        \n        // Simple column detection\n        const sortedByX = xCoordinates.sort((a, b) => a.center - b.center);\n        let columns = 1;\n        let lastCenter = sortedByX[0].center;\n        \n        for (let i = 1; i < sortedByX.length; i++) {\n            if (sortedByX[i].center - lastCenter > 100) { // Threshold for column gap\n                columns++;\n                lastCenter = sortedByX[i].center;\n            }\n        }\n        \n        return {\n            type: columns > 1 ? 'multi-column' : 'single-column',\n            columns,\n            rows: lines.length\n        };\n    }\n    \n    assessQuality(ocrResult) {\n        const avgConfidence = this.calculateAverageConfidence(ocrResult);\n        \n        if (avgConfidence >= 0.9) return 'excellent';\n        if (avgConfidence >= 0.8) return 'good';\n        if (avgConfidence >= 0.6) return 'fair';\n        if (avgConfidence >= 0.4) return 'poor';\n        return 'very poor';\n    }\n}\n\n/**\n * Table detection and extraction from OCR results\n */\nexport class TableExtractor {\n    constructor() {\n        this.cellGapThreshold = 30;\n        this.rowGapThreshold = 10;\n    }\n    \n    extractTables(ocrResult) {\n        if (!ocrResult.lines || ocrResult.lines.length === 0) {\n            return [];\n        }\n        \n        // Group text into potential table cells\n        const cells = this.groupIntoCells(ocrResult.lines);\n        \n        // Detect table structure\n        const tables = this.detectTableStructure(cells);\n        \n        // Format tables\n        return tables.map(table => this.formatTable(table));\n    }\n    \n    groupIntoCells(lines) {\n        // Sort lines by position\n        const sorted = sortTextRegions(lines);\n        \n        // Group into rows based on y-coordinate proximity\n        const rows = [];\n        let currentRow = [sorted[0]];\n        \n        for (let i = 1; i < sorted.length; i++) {\n            const prevCenter = this.getCenter(sorted[i - 1].box);\n            const currCenter = this.getCenter(sorted[i].box);\n            \n            if (Math.abs(currCenter[1] - prevCenter[1]) < this.rowGapThreshold) {\n                currentRow.push(sorted[i]);\n            } else {\n                rows.push(currentRow);\n                currentRow = [sorted[i]];\n            }\n        }\n        if (currentRow.length > 0) {\n            rows.push(currentRow);\n        }\n        \n        return rows;\n    }\n    \n    detectTableStructure(rows) {\n        // Simple table detection: rows with similar number of cells\n        const tables = [];\n        let currentTable = [];\n        \n        for (const row of rows) {\n            if (currentTable.length === 0) {\n                currentTable.push(row);\n            } else {\n                const prevCellCount = currentTable[currentTable.length - 1].length;\n                const currCellCount = row.length;\n                \n                // Allow some variation in cell count\n                if (Math.abs(prevCellCount - currCellCount) <= 1) {\n                    currentTable.push(row);\n                } else {\n                    if (currentTable.length > 1) {\n                        tables.push(currentTable);\n                    }\n                    currentTable = [row];\n                }\n            }\n        }\n        \n        if (currentTable.length > 1) {\n            tables.push(currentTable);\n        }\n        \n        return tables;\n    }\n    \n    formatTable(tableRows) {\n        const maxCells = Math.max(...tableRows.map(row => row.length));\n        \n        // Normalize rows to have same number of cells\n        const normalizedRows = tableRows.map(row => {\n            const cells = row.map(cell => cell.text);\n            while (cells.length < maxCells) {\n                cells.push('');\n            }\n            return cells;\n        });\n        \n        return {\n            rows: normalizedRows.length,\n            columns: maxCells,\n            data: normalizedRows,\n            confidence: this.calculateTableConfidence(tableRows)\n        };\n    }\n    \n    calculateTableConfidence(tableRows) {\n        let totalConfidence = 0;\n        let cellCount = 0;\n        \n        for (const row of tableRows) {\n            for (const cell of row) {\n                totalConfidence += cell.confidence;\n                cellCount++;\n            }\n        }\n        \n        return cellCount > 0 ? totalConfidence / cellCount : 0;\n    }\n    \n    getCenter(box) {\n        const sumX = box.reduce((sum, p) => sum + p[0], 0);\n        const sumY = box.reduce((sum, p) => sum + p[1], 0);\n        return [sumX / box.length, sumY / box.length];\n    }\n}\n\n// All classes are already exported above","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var defineProperty = Object.defineProperty || function (obj, key, desc) { obj[key] = desc.value; };\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    defineProperty(generator, \"_invoke\", { value: makeInvokeMethod(innerFn, self, context) });\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  defineProperty(Gp, \"constructor\", { value: GeneratorFunctionPrototype, configurable: true });\n  defineProperty(\n    GeneratorFunctionPrototype,\n    \"constructor\",\n    { value: GeneratorFunction, configurable: true }\n  );\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    defineProperty(this, \"_invoke\", { value: enqueue });\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var methodName = context.method;\n    var method = delegate.iterator[methodName];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method, or a missing .next mehtod, always terminate the\n      // yield* loop.\n      context.delegate = null;\n\n      // Note: [\"return\"] must be used for ES3 parsing compatibility.\n      if (methodName === \"throw\" && delegate.iterator[\"return\"]) {\n        // If the delegate iterator has a return method, give it a\n        // chance to clean up.\n        context.method = \"return\";\n        context.arg = undefined;\n        maybeInvokeDelegate(delegate, context);\n\n        if (context.method === \"throw\") {\n          // If maybeInvokeDelegate(context) changed context.method from\n          // \"return\" to \"throw\", let that override the TypeError below.\n          return ContinueSentinel;\n        }\n      }\n      if (methodName !== \"return\") {\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a '\" + methodName + \"' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(val) {\n    var object = Object(val);\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","module.exports = (prefix, cnt) => (\n  `${prefix}-${cnt}-${Math.random().toString(16).slice(3, 8)}`\n);\n","const getId = require('./utils/getId');\n\nlet jobCounter = 0;\n\nmodule.exports = ({\n  id: _id,\n  action,\n  payload = {},\n}) => {\n  let id = _id;\n  if (typeof id === 'undefined') {\n    id = getId('Job', jobCounter);\n    jobCounter += 1;\n  }\n\n  return {\n    id,\n    action,\n    payload,\n  };\n};\n","let logging = false;\n\nexports.logging = logging;\n\nexports.setLogging = (_logging) => {\n  logging = _logging;\n};\n\nexports.log = (...args) => (logging ? console.log.apply(this, args) : null);\n","// https://github.com/electron/electron/issues/2288\nfunction isElectron() {\n    // Renderer process\n    if (typeof window !== 'undefined' && typeof window.process === 'object' && window.process.type === 'renderer') {\n        return true;\n    }\n\n    // Main process\n    if (typeof process !== 'undefined' && typeof process.versions === 'object' && !!process.versions.electron) {\n        return true;\n    }\n\n    // Detect the user agent when the `nodeIntegration` option is set to false\n    if (typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent.indexOf('Electron') >= 0) {\n        return true;\n    }\n\n    return false;\n}\n\nmodule.exports = isElectron;\n","const isElectron = require('is-electron');\n\nmodule.exports = (key) => {\n  const env = {};\n\n  if (typeof WorkerGlobalScope !== 'undefined') {\n    env.type = 'webworker';\n  } else if (isElectron()) {\n    env.type = 'electron';\n  } else if (typeof document === 'object') {\n    env.type = 'browser';\n  } else if (typeof process === 'object' && typeof require === 'function') {\n    env.type = 'node';\n  }\n\n  if (typeof key === 'undefined') {\n    return env;\n  }\n\n  return env[key];\n};\n","const isBrowser = require('./getEnvironment')('type') === 'browser';\n\nconst resolveURL = isBrowser ? s => (new URL(s, window.location.href)).href : s => s; // eslint-disable-line\n\nmodule.exports = (options) => {\n  const opts = { ...options };\n  ['corePath', 'workerPath', 'langPath'].forEach((key) => {\n    if (options[key]) {\n      opts[key] = resolveURL(opts[key]);\n    }\n  });\n  return opts;\n};\n","/**\n * In the recognition result of tesseract, there\n * is a deep JSON object for details, it has around\n *\n * The result of dump.js is a big JSON tree\n * which can be easily serialized (for instance\n * to be sent from a webworker to the main app\n * or through Node's IPC), but we want\n * a (circular) DOM-like interface for walking\n * through the data.\n *\n * @fileoverview DOM-like interface for walking through data\n * @author Kevin Kwok <antimatter15@gmail.com>\n * @author Guillermo Webster <gui@mit.edu>\n * @author Jerome Wu <jeromewus@gmail.com>\n */\n\nmodule.exports = (page) => {\n  const blocks = [];\n  const paragraphs = [];\n  const lines = [];\n  const words = [];\n  const symbols = [];\n\n  if (page.blocks) {\n    page.blocks.forEach((block) => {\n      block.paragraphs.forEach((paragraph) => {\n        paragraph.lines.forEach((line) => {\n          line.words.forEach((word) => {\n            word.symbols.forEach((sym) => {\n              symbols.push({\n                ...sym, page, block, paragraph, line, word,\n              });\n            });\n            words.push({\n              ...word, page, block, paragraph, line,\n            });\n          });\n          lines.push({\n            ...line, page, block, paragraph,\n          });\n        });\n        paragraphs.push({\n          ...paragraph, page, block,\n        });\n      });\n      blocks.push({\n        ...block, page,\n      });\n    });\n  }\n\n  return {\n    ...page, blocks, paragraphs, lines, words, symbols,\n  };\n};\n","/*\n * OEM = OCR Engine Mode, and there are 4 possible modes.\n *\n * By default tesseract.js uses LSTM_ONLY mode.\n *\n */\nmodule.exports = {\n  TESSERACT_ONLY: 0,\n  LSTM_ONLY: 1,\n  TESSERACT_LSTM_COMBINED: 2,\n  DEFAULT: 3,\n};\n","module.exports = {\n  /*\n   * Use BlobURL for worker script by default\n   * TODO: remove this option\n   *\n   */\n  workerBlobURL: true,\n  logger: () => {},\n};\n","const version = require('../../../package.json').version;\nconst defaultOptions = require('../../constants/defaultOptions');\n\n/*\n * Default options for browser worker\n */\nmodule.exports = {\n  ...defaultOptions,\n  workerPath: `https://cdn.jsdelivr.net/npm/tesseract.js@v${version}/dist/worker.min.js`,\n};\n","/**\n * spawnWorker\n *\n * @name spawnWorker\n * @function create a new Worker in browser\n * @access public\n */\nmodule.exports = ({ workerPath, workerBlobURL }) => {\n  let worker;\n  if (Blob && URL && workerBlobURL) {\n    const blob = new Blob([`importScripts(\"${workerPath}\");`], {\n      type: 'application/javascript',\n    });\n    worker = new Worker(URL.createObjectURL(blob));\n  } else {\n    worker = new Worker(workerPath);\n  }\n\n  return worker;\n};\n","/**\n * terminateWorker\n *\n * @name terminateWorker\n * @function terminate worker\n * @access public\n */\nmodule.exports = (worker) => {\n  worker.terminate();\n};\n","module.exports = (worker, handler) => {\n  worker.onmessage = ({ data }) => { // eslint-disable-line\n    handler(data);\n  };\n};\n","/**\n * send\n *\n * @name send\n * @function send packet to worker and create a job\n * @access public\n */\nmodule.exports = async (worker, packet) => {\n  worker.postMessage(packet);\n};\n","/**\n * readFromBlobOrFile\n *\n * @name readFromBlobOrFile\n * @function\n * @access private\n */\nconst readFromBlobOrFile = (blob) => (\n  new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n    fileReader.onload = () => {\n      resolve(fileReader.result);\n    };\n    fileReader.onerror = ({ target: { error: { code } } }) => {\n      reject(Error(`File could not be read! Code=${code}`));\n    };\n    fileReader.readAsArrayBuffer(blob);\n  })\n);\n\n/**\n * loadImage\n *\n * @name loadImage\n * @function load image from different source\n * @access private\n */\nconst loadImage = async (image) => {\n  let data = image;\n  if (typeof image === 'undefined') {\n    return 'undefined';\n  }\n\n  if (typeof image === 'string') {\n    // Base64 Image\n    if (/data:image\\/([a-zA-Z]*);base64,([^\"]*)/.test(image)) {\n      data = atob(image.split(',')[1])\n        .split('')\n        .map((c) => c.charCodeAt(0));\n    } else {\n      const resp = await fetch(image);\n      data = await resp.arrayBuffer();\n    }\n  } else if (typeof HTMLElement !== 'undefined' && image instanceof HTMLElement) {\n    if (image.tagName === 'IMG') {\n      data = await loadImage(image.src);\n    }\n    if (image.tagName === 'VIDEO') {\n      data = await loadImage(image.poster);\n    }\n    if (image.tagName === 'CANVAS') {\n      await new Promise((resolve) => {\n        image.toBlob(async (blob) => {\n          data = await readFromBlobOrFile(blob);\n          resolve();\n        });\n      });\n    }\n  } else if (typeof OffscreenCanvas !== 'undefined' && image instanceof OffscreenCanvas) {\n    const blob = await image.convertToBlob();\n    data = await readFromBlobOrFile(blob);\n  } else if (image instanceof File || image instanceof Blob) {\n    data = await readFromBlobOrFile(image);\n  }\n\n  return new Uint8Array(data);\n};\n\nmodule.exports = loadImage;\n","/**\n *\n * Tesseract Worker adapter for browser\n *\n * @fileoverview Tesseract Worker adapter for browser\n * @author Kevin Kwok <antimatter15@gmail.com>\n * @author Guillermo Webster <gui@mit.edu>\n * @author Jerome Wu <jeromewus@gmail.com>\n */\nconst defaultOptions = require('./defaultOptions');\nconst spawnWorker = require('./spawnWorker');\nconst terminateWorker = require('./terminateWorker');\nconst onMessage = require('./onMessage');\nconst send = require('./send');\nconst loadImage = require('./loadImage');\n\nmodule.exports = {\n  defaultOptions,\n  spawnWorker,\n  terminateWorker,\n  onMessage,\n  send,\n  loadImage,\n};\n","const resolvePaths = require('./utils/resolvePaths');\nconst circularize = require('./utils/circularize');\nconst createJob = require('./createJob');\nconst { log } = require('./utils/log');\nconst getId = require('./utils/getId');\nconst OEM = require('./constants/OEM');\nconst {\n  defaultOptions,\n  spawnWorker,\n  terminateWorker,\n  onMessage,\n  loadImage,\n  send,\n} = require('./worker/node');\n\nlet workerCounter = 0;\n\nmodule.exports = async (langs = 'eng', oem = OEM.LSTM_ONLY, _options = {}, config = {}) => {\n  const id = getId('Worker', workerCounter);\n  const {\n    logger,\n    errorHandler,\n    ...options\n  } = resolvePaths({\n    ...defaultOptions,\n    ..._options,\n  });\n  const resolves = {};\n  const rejects = {};\n\n  // Current langs, oem, and config file.\n  // Used if the user ever re-initializes the worker using `worker.reinitialize`.\n  const currentLangs = typeof langs === 'string' ? langs.split('+') : langs;\n  let currentOem = oem;\n  let currentConfig = config;\n  const lstmOnlyCore = [OEM.DEFAULT, OEM.LSTM_ONLY].includes(oem) && !options.legacyCore;\n\n  let workerResReject;\n  let workerResResolve;\n  const workerRes = new Promise((resolve, reject) => {\n    workerResResolve = resolve;\n    workerResReject = reject;\n  });\n  const workerError = (event) => { workerResReject(event.message); };\n\n  let worker = spawnWorker(options);\n  worker.onerror = workerError;\n\n  workerCounter += 1;\n\n  const setResolve = (promiseId, res) => {\n    resolves[promiseId] = res;\n  };\n\n  const setReject = (promiseId, rej) => {\n    rejects[promiseId] = rej;\n  };\n\n  const startJob = ({ id: jobId, action, payload }) => (\n    new Promise((resolve, reject) => {\n      log(`[${id}]: Start ${jobId}, action=${action}`);\n      // Using both `action` and `jobId` in case user provides non-unique `jobId`.\n      const promiseId = `${action}-${jobId}`;\n      setResolve(promiseId, resolve);\n      setReject(promiseId, reject);\n      send(worker, {\n        workerId: id,\n        jobId,\n        action,\n        payload,\n      });\n    })\n  );\n\n  const load = () => (\n    console.warn('`load` is depreciated and should be removed from code (workers now come pre-loaded)')\n  );\n\n  const loadInternal = (jobId) => (\n    startJob(createJob({\n      id: jobId, action: 'load', payload: { options: { lstmOnly: lstmOnlyCore, corePath: options.corePath, logging: options.logging } },\n    }))\n  );\n\n  const writeText = (path, text, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'FS',\n      payload: { method: 'writeFile', args: [path, text] },\n    }))\n  );\n\n  const readText = (path, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'FS',\n      payload: { method: 'readFile', args: [path, { encoding: 'utf8' }] },\n    }))\n  );\n\n  const removeFile = (path, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'FS',\n      payload: { method: 'unlink', args: [path] },\n    }))\n  );\n\n  const FS = (method, args, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'FS',\n      payload: { method, args },\n    }))\n  );\n\n  const loadLanguage = () => (\n    console.warn('`loadLanguage` is depreciated and should be removed from code (workers now come with language pre-loaded)')\n  );\n\n  const loadLanguageInternal = (_langs, jobId) => startJob(createJob({\n    id: jobId,\n    action: 'loadLanguage',\n    payload: {\n      langs: _langs,\n      options: {\n        langPath: options.langPath,\n        dataPath: options.dataPath,\n        cachePath: options.cachePath,\n        cacheMethod: options.cacheMethod,\n        gzip: options.gzip,\n        lstmOnly: [OEM.DEFAULT, OEM.LSTM_ONLY].includes(currentOem)\n          && !options.legacyLang,\n      },\n    },\n  }));\n\n  const initialize = () => (\n    console.warn('`initialize` is depreciated and should be removed from code (workers now come pre-initialized)')\n  );\n\n  const initializeInternal = (_langs, _oem, _config, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'initialize',\n      payload: { langs: _langs, oem: _oem, config: _config },\n    }))\n  );\n\n  const reinitialize = (langs = 'eng', oem, config, jobId) => { // eslint-disable-line\n\n    if (lstmOnlyCore && [OEM.TESSERACT_ONLY, OEM.TESSERACT_LSTM_COMBINED].includes(oem)) throw Error('Legacy model requested but code missing.');\n\n    const _oem = oem || currentOem;\n    currentOem = _oem;\n\n    const _config = config || currentConfig;\n    currentConfig = _config;\n\n    // Only load langs that are not already loaded.\n    // This logic fails if the user downloaded the LSTM-only English data for a language\n    // and then uses `worker.reinitialize` to switch to the Legacy engine.\n    // However, the correct data will still be downloaded after initialization fails\n    // and this can be avoided entirely if the user loads the correct data ahead of time.\n    const langsArr = typeof langs === 'string' ? langs.split('+') : langs;\n    const _langs = langsArr.filter((x) => !currentLangs.includes(x));\n    currentLangs.push(..._langs);\n\n    if (_langs.length > 0) {\n      return loadLanguageInternal(_langs, jobId)\n        .then(() => initializeInternal(langs, _oem, _config, jobId));\n    }\n\n    return initializeInternal(langs, _oem, _config, jobId);\n  };\n\n  const setParameters = (params = {}, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'setParameters',\n      payload: { params },\n    }))\n  );\n\n  const recognize = async (image, opts = {}, output = {\n    blocks: true, text: true, hocr: true, tsv: true,\n  }, jobId) => (\n    startJob(createJob({\n      id: jobId,\n      action: 'recognize',\n      payload: { image: await loadImage(image), options: opts, output },\n    }))\n  );\n\n  const getPDF = (title = 'Tesseract OCR Result', textonly = false, jobId) => {\n    console.log('`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead.');\n    return startJob(createJob({\n      id: jobId,\n      action: 'getPDF',\n      payload: { title, textonly },\n    }));\n  };\n\n  const detect = async (image, jobId) => {\n    if (lstmOnlyCore) throw Error('`worker.detect` requires Legacy model, which was not loaded.');\n\n    return startJob(createJob({\n      id: jobId,\n      action: 'detect',\n      payload: { image: await loadImage(image) },\n    }));\n  };\n\n  const terminate = async () => {\n    if (worker !== null) {\n      /*\n      await startJob(createJob({\n        id: jobId,\n        action: 'terminate',\n      }));\n      */\n      terminateWorker(worker);\n      worker = null;\n    }\n    return Promise.resolve();\n  };\n\n  onMessage(worker, ({\n    workerId, jobId, status, action, data,\n  }) => {\n    const promiseId = `${action}-${jobId}`;\n    if (status === 'resolve') {\n      log(`[${workerId}]: Complete ${jobId}`);\n      let d = data;\n      if (action === 'recognize') {\n        d = circularize(data);\n      } else if (action === 'getPDF') {\n        d = Array.from({ ...data, length: Object.keys(data).length });\n      }\n      resolves[promiseId]({ jobId, data: d });\n    } else if (status === 'reject') {\n      rejects[promiseId](data);\n      if (action === 'load') workerResReject(data);\n      if (errorHandler) {\n        errorHandler(data);\n      } else {\n        throw Error(data);\n      }\n    } else if (status === 'progress') {\n      logger({ ...data, userJobId: jobId });\n    }\n  });\n\n  const resolveObj = {\n    id,\n    worker,\n    setResolve,\n    setReject,\n    load,\n    writeText,\n    readText,\n    removeFile,\n    FS,\n    loadLanguage,\n    initialize,\n    reinitialize,\n    setParameters,\n    recognize,\n    getPDF,\n    detect,\n    terminate,\n  };\n\n  loadInternal()\n    .then(() => loadLanguageInternal(langs))\n    .then(() => initializeInternal(langs, oem, config))\n    .then(() => workerResResolve(resolveObj))\n    .catch(() => {});\n\n  return workerRes;\n};\n","const createWorker = require('./createWorker');\n\nconst recognize = async (image, langs, options) => {\n  const worker = await createWorker(langs, 1, options);\n  return worker.recognize(image)\n    .finally(async () => {\n      await worker.terminate();\n    });\n};\n\nconst detect = async (image, options) => {\n  const worker = await createWorker('osd', 0, options);\n  return worker.detect(image)\n    .finally(async () => {\n      await worker.terminate();\n    });\n};\n\nmodule.exports = {\n  recognize,\n  detect,\n};\n","/**\n *\n * Entry point for tesseract.js, should be the entry when bundling.\n *\n * @fileoverview entry point for tesseract.js\n * @author Kevin Kwok <antimatter15@gmail.com>\n * @author Guillermo Webster <gui@mit.edu>\n * @author Jerome Wu <jeromewus@gmail.com>\n */\nrequire('regenerator-runtime/runtime');\nconst createScheduler = require('./createScheduler');\nconst createWorker = require('./createWorker');\nconst Tesseract = require('./Tesseract');\nconst languages = require('./constants/languages');\nconst OEM = require('./constants/OEM');\nconst PSM = require('./constants/PSM');\nconst { setLogging } = require('./utils/log');\n\nmodule.exports = {\n  languages,\n  OEM,\n  PSM,\n  createScheduler,\n  createWorker,\n  setLogging,\n  ...Tesseract,\n};\n","/**\n * Utility functions for the OCR application\n * Centralizes path handling and common utilities\n */\n\n/**\n * The name of the repository, used for GitHub Pages deployment.\n * This is the only place you should need to change the repo name.\n */\nconst REPO_NAME = 'client-ocr-app';\n\n/**\n * Determines the base path for assets.\n * For local development, it's the root '/'.\n * For GitHub Pages, it's '/<repo-name>/'.\n */\nconst isGitHubPages = window.location.hostname.includes('github.io');\nconst basePath = isGitHubPages ? `/${REPO_NAME}/` : '/';\n\n/**\n * Constructs a full, correct URL for a project asset.\n * It correctly handles local development vs. GitHub Pages deployment.\n *\n * @param {string} relativePath - The path to the asset relative to the project root\n *   (e.g., 'models/PP-OCRv5/det/det.onnx').\n * @returns {string} The absolute URL for the asset.\n */\nexport function getAssetUrl(relativePath) {\n  // Remove leading slash if present to avoid double slashes\n  const cleanPath = relativePath.startsWith('/') ? relativePath.slice(1) : relativePath;\n  \n  // The URL constructor robustly joins the base URL and relative path\n  return new URL(cleanPath, new URL(basePath, window.location.origin)).href;\n}\n\n/**\n * Get the base path for the application\n * @returns {string} The base path with trailing slash\n */\nexport function getBasePath() {\n  return basePath;\n}\n\n/**\n * Check if running on GitHub Pages\n * @returns {boolean} True if on GitHub Pages\n */\nexport function isOnGitHubPages() {\n  return isGitHubPages;\n}\n\n/**\n * Format file size in human-readable format\n * @param {number} bytes - File size in bytes\n * @returns {string} Formatted file size\n */\nexport function formatFileSize(bytes) {\n  if (bytes === 0) return '0 Bytes';\n  \n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  \n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\n/**\n * Create a unique ID\n * @returns {string} Unique identifier\n */\nexport function generateId() {\n  return Date.now().toString(36) + Math.random().toString(36).substr(2);\n}\n\n/**\n * Debounce function to limit function calls\n * @param {Function} func - Function to debounce\n * @param {number} wait - Wait time in milliseconds\n * @returns {Function} Debounced function\n */\nexport function debounce(func, wait) {\n  let timeout;\n  return function executedFunction(...args) {\n    const later = () => {\n      clearTimeout(timeout);\n      func(...args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n}\n\n/**\n * Check if the environment supports cross-origin isolation\n * @returns {boolean} True if cross-origin isolated\n */\nexport function isCrossOriginIsolated() {\n  return 'crossOriginIsolated' in self && self.crossOriginIsolated;\n}\n\n/**\n * Get the number of CPU threads available\n * @returns {number} Number of threads (1 if not cross-origin isolated)\n */\nexport function getAvailableThreads() {\n  if (!isCrossOriginIsolated()) {\n    return 1;\n  }\n  return navigator.hardwareConcurrency || 4;\n}","/**\n * Centralized configuration for OCR models and application settings\n */\n\nimport { getAssetUrl, getAvailableThreads } from './utils.js';\n\n/**\n * OCR Engine Types\n */\nexport const ENGINE_TYPES = {\n  TESSERACT: 'tesseract',\n  PADDLE_OCR: 'paddleocr',\n  PPOCR_V5: 'ppocr-v5'\n};\n\n/**\n * Centralized configuration for all available OCR models.\n * Each model includes paths to all required files and metadata.\n */\nexport const OCR_MODELS = {\n  'PP-OCRv5': {\n    id: 'PP-OCRv5',\n    name: 'PP-OCRv5 (Latest)',\n    description: 'Latest and most accurate model with best performance',\n    type: 'server',\n    engine: ENGINE_TYPES.PPOCR_V5,\n    paths: {\n      det: getAssetUrl('models/PP-OCRv5/det/det.onnx'),\n      cls: getAssetUrl('models/PP-OCRv5/cls/cls.onnx'),\n      rec: getAssetUrl('models/PP-OCRv5/rec/rec.onnx'),\n      dict: getAssetUrl('models/PP-OCRv5/ppocrv5_dict.txt')\n    },\n    settings: {\n      det_limit_side_len: 960,\n      det_db_thresh: 0.3,\n      det_db_box_thresh: 0.6,\n      det_db_unclip_ratio: 1.7,\n      cls_thresh: 0.9,\n      rec_image_shape: [3, 48, 320],\n      cls_image_shape: [3, 48, 192]\n    }\n  },\n  'PP-OCRv4': {\n    id: 'PP-OCRv4',\n    name: 'PP-OCRv4',\n    description: 'Previous generation model, stable and reliable',\n    type: 'server',\n    engine: ENGINE_TYPES.PPOCR_V5,\n    paths: {\n      det: getAssetUrl('models/PP-OCRv4/det/det.onnx'),\n      cls: getAssetUrl('models/PP-OCRv4/cls/cls.onnx'),\n      rec: getAssetUrl('models/PP-OCRv4/rec/rec.onnx'),\n      dict: getAssetUrl('models/PP-OCRv4/ppocr_keys_v1.txt')\n    },\n    settings: {\n      det_limit_side_len: 960,\n      det_db_thresh: 0.3,\n      det_db_box_thresh: 0.6,\n      det_db_unclip_ratio: 1.7,\n      cls_thresh: 0.9,\n      rec_image_shape: [3, 48, 320],\n      cls_image_shape: [3, 48, 192]\n    }\n  },\n  'ch_ppocr_server_v2.0': {\n    id: 'ch_ppocr_server_v2.0',\n    name: 'Server v2.0',\n    description: 'Chinese server model v2.0',\n    type: 'server',\n    engine: ENGINE_TYPES.PPOCR_V5,\n    paths: {\n      det: getAssetUrl('models/ch_ppocr_server_v2.0/det/det.onnx'),\n      cls: getAssetUrl('models/ch_ppocr_server_v2.0/cls/cls.onnx'),\n      rec: getAssetUrl('models/PP-OCRv4/rec/rec.onnx'), // Fallback to v4 rec\n      dict: getAssetUrl('models/ch_ppocr_server_v2.0/ppocr_keys_v1.txt')\n    },\n    settings: {\n      det_limit_side_len: 960,\n      det_db_thresh: 0.3,\n      det_db_box_thresh: 0.5,\n      det_db_unclip_ratio: 1.6,\n      cls_thresh: 0.9,\n      rec_image_shape: [3, 32, 320],\n      cls_image_shape: [3, 48, 192]\n    }\n  },\n  'PP-OCRv5_mobile': {\n    id: 'PP-OCRv5_mobile',\n    name: 'PP-OCRv5 Mobile',\n    description: 'Lightweight model optimized for mobile/web',\n    type: 'mobile',\n    engine: ENGINE_TYPES.PPOCR_V5,\n    paths: {\n      det: getAssetUrl('models/PP-OCRv5_mobile_det_infer.onnx'),\n      cls: getAssetUrl('models/PP-OCRv5/cls/cls.onnx'),\n      rec: getAssetUrl('models/PP-OCRv5_mobile_rec_infer.onnx'),\n      dict: getAssetUrl('models/ppocrv5_dict.txt')\n    },\n    settings: {\n      det_limit_side_len: 640,\n      det_db_thresh: 0.3,\n      det_db_box_thresh: 0.5,\n      det_db_unclip_ratio: 1.5,\n      cls_thresh: 0.9,\n      rec_image_shape: [3, 48, 320],\n      cls_image_shape: [3, 48, 192]\n    }\n  },\n  'PP-OCRv4_mobile': {\n    id: 'PP-OCRv4_mobile',\n    name: 'PP-OCRv4 Mobile',\n    description: 'Lightweight v4 model for mobile/web',\n    type: 'mobile',\n    engine: ENGINE_TYPES.PPOCR_V5,\n    paths: {\n      det: getAssetUrl('models/PP-OCRv4/det/det.onnx'),\n      cls: getAssetUrl('models/PP-OCRv4/cls/cls.onnx'),\n      rec: getAssetUrl('models/en_PP-OCRv4_mobile_rec_infer.onnx'),\n      dict: getAssetUrl('models/en_dict.txt')\n    },\n    settings: {\n      det_limit_side_len: 640,\n      det_db_thresh: 0.3,\n      det_db_box_thresh: 0.5,\n      det_db_unclip_ratio: 1.5,\n      cls_thresh: 0.9,\n      rec_image_shape: [3, 48, 320],\n      cls_image_shape: [3, 48, 192]\n    }\n  }\n};\n\n/**\n * Preset configurations for different use cases\n */\nexport const PRESET_CONFIGS = {\n  balanced: {\n    name: 'Balanced (Default)',\n    description: 'Good balance between speed and accuracy',\n    modelId: 'PP-OCRv5',\n    settings: {\n      useAngleCls: true,\n      useCache: true,\n      batchSize: 5\n    }\n  },\n  high_accuracy: {\n    name: 'High Accuracy',\n    description: 'Maximum accuracy, slower processing',\n    modelId: 'PP-OCRv5',\n    settings: {\n      useAngleCls: true,\n      useCache: true,\n      batchSize: 3,\n      det_db_thresh: 0.2,\n      det_db_box_thresh: 0.5\n    }\n  },\n  fast_processing: {\n    name: 'Fast Processing',\n    description: 'Optimized for speed',\n    modelId: 'PP-OCRv5_mobile',\n    settings: {\n      useAngleCls: false,\n      useCache: true,\n      batchSize: 10,\n      det_limit_side_len: 480\n    }\n  },\n  handwritten: {\n    name: 'Handwritten Text',\n    description: 'Optimized for handwritten content',\n    modelId: 'PP-OCRv5',\n    settings: {\n      useAngleCls: true,\n      useCache: true,\n      batchSize: 3,\n      det_db_thresh: 0.2,\n      det_db_unclip_ratio: 2.0\n    }\n  },\n  low_quality: {\n    name: 'Low Quality Images',\n    description: 'For poor quality or low resolution images',\n    modelId: 'PP-OCRv5',\n    settings: {\n      useAngleCls: true,\n      useCache: true,\n      batchSize: 3,\n      det_db_thresh: 0.2,\n      det_db_box_thresh: 0.4,\n      det_db_unclip_ratio: 2.2\n    }\n  }\n};\n\n/**\n * ONNX Runtime Web configuration\n */\nexport const ORT_CONFIG = {\n  wasmPaths: getAssetUrl('assets/'),\n  numThreads: getAvailableThreads(),\n  graphOptimizationLevel: 'all',\n  executionMode: 'sequential',\n  enableCpuMemArena: true,\n  enableMemPattern: true,\n  logLevel: 'warning',\n  providers: ['wasm'] // Can be extended with 'webgl', 'webgpu' when available\n};\n\n/**\n * Tesseract.js configuration\n */\nexport const TESSERACT_CONFIG = {\n  workerPath: 'https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/worker.min.js',\n  langPath: 'https://tessdata.projectnaptha.com/4.0.0',\n  corePath: 'https://cdn.jsdelivr.net/npm/tesseract.js-core@5/tesseract-core-simd.wasm.js',\n  defaultLang: 'eng',\n  logger: m => console.log('[Tesseract]', m)\n};\n\n/**\n * Application settings\n */\nexport const APP_CONFIG = {\n  maxFileSize: 10 * 1024 * 1024, // 10MB\n  supportedFormats: ['image/jpeg', 'image/png', 'image/webp', 'image/bmp', 'application/pdf'],\n  cacheExpiration: 24 * 60 * 60 * 1000, // 24 hours\n  maxCacheSize: 50 * 1024 * 1024, // 50MB\n  defaultEngine: ENGINE_TYPES.PADDLE_OCR,\n  defaultModel: 'PP-OCRv5',\n  defaultPreset: 'balanced'\n};\n\n/**\n * Get model configuration by ID\n * @param {string} modelId - Model identifier\n * @returns {Object|null} Model configuration or null if not found\n */\nexport function getModelConfig(modelId) {\n  return OCR_MODELS[modelId] || null;\n}\n\n/**\n * Get preset configuration by ID\n * @param {string} presetId - Preset identifier\n * @returns {Object|null} Preset configuration or null if not found\n */\nexport function getPresetConfig(presetId) {\n  return PRESET_CONFIGS[presetId] || null;\n}\n\n/**\n * Get all available models for a specific engine type\n * @param {string} engineType - Engine type from ENGINE_TYPES\n * @returns {Array} Array of model configurations\n */\nexport function getModelsForEngine(engineType) {\n  return Object.values(OCR_MODELS).filter(model => model.engine === engineType);\n}\n\n/**\n * Merge preset settings with model settings\n * @param {string} modelId - Model identifier\n * @param {string} presetId - Preset identifier\n * @returns {Object} Merged configuration\n */\nexport function getMergedConfig(modelId, presetId) {\n  const model = getModelConfig(modelId);\n  const preset = getPresetConfig(presetId);\n  \n  if (!model) {\n    throw new Error(`Model ${modelId} not found`);\n  }\n  \n  const settings = {\n    ...model.settings,\n    ...(preset?.settings || {})\n  };\n  \n  return {\n    ...model,\n    settings,\n    presetId\n  };\n}","/**\n * Main entry point for Smart OCR PWA\n * Refactored to use centralized configuration and better architecture\n */\n\nimport Tesseract from 'tesseract.js';\nimport { PaddleOCR } from './paddle-ocr.js';\nimport { \n    OCR_MODELS, \n    PRESET_CONFIGS, \n    ENGINE_TYPES,\n    TESSERACT_CONFIG,\n    APP_CONFIG,\n    getModelConfig,\n    getPresetConfig\n} from './config.js';\nimport { getAssetUrl, formatFileSize, isCrossOriginIsolated } from './utils.js';\nimport { ocrCache } from './ocr-cache-manager.js';\n\n// Global state\nconst engines = {\n    tesseract: null,\n    paddleOCR: null\n};\n\n// Current selections\nlet currentEngine = APP_CONFIG.defaultEngine;\nlet currentModelId = APP_CONFIG.defaultModel;\nlet currentPresetId = APP_CONFIG.defaultPreset;\n\n/**\n * Initialize service worker\n */\nasync function initializeServiceWorker() {\n    if ('serviceWorker' in navigator) {\n        try {\n            // Use enhanced service worker for COOP/COEP\n            const swPath = getAssetUrl('sw-enhanced.js');\n            const registration = await navigator.serviceWorker.register(swPath, {\n                scope: getAssetUrl('')\n            });\n            \n            console.log('Service Worker registered:', registration.scope);\n            \n            // Check if we have cross-origin isolation\n            if (isCrossOriginIsolated()) {\n                console.log('Cross-origin isolation enabled - WebAssembly threading available');\n            }\n            \n            return registration;\n        } catch (error) {\n            console.error('Service Worker registration failed:', error);\n        }\n    }\n}\n\n/**\n * Initialize Tesseract engine\n */\nasync function initializeTesseract(progressCallback = null) {\n    if (engines.tesseract) {\n        return engines.tesseract;\n    }\n\n    progressCallback?.('Initializing Tesseract...');\n    \n    engines.tesseract = await Tesseract.createWorker('eng', 1, {\n        logger: TESSERACT_CONFIG.logger,\n        workerPath: TESSERACT_CONFIG.workerPath,\n        langPath: TESSERACT_CONFIG.langPath,\n        corePath: TESSERACT_CONFIG.corePath\n    });\n    \n    progressCallback?.('Tesseract ready!');\n    \n    return engines.tesseract;\n}\n\n/**\n * Initialize PaddleOCR engine with selected model\n */\nasync function initializePaddleOCR(modelId = null, presetId = null, progressCallback = null) {\n    if (!engines.paddleOCR) {\n        engines.paddleOCR = new PaddleOCR();\n    }\n    \n    await engines.paddleOCR.initialize({\n        modelId: modelId || currentModelId,\n        presetId: presetId || currentPresetId,\n        progressCallback\n    });\n    \n    return engines.paddleOCR;\n}\n\n/**\n * Process image with selected engine\n */\nasync function processImage(file, options = {}, progressCallback = null) {\n    const {\n        engine = currentEngine,\n        modelId = currentModelId,\n        presetId = currentPresetId,\n        useCache = true\n    } = options;\n    \n    // Check file size\n    if (file.size > APP_CONFIG.maxFileSize) {\n        throw new Error(`File too large. Maximum size is ${formatFileSize(APP_CONFIG.maxFileSize)}`);\n    }\n    \n    // Check file type\n    if (!APP_CONFIG.supportedFormats.includes(file.type)) {\n        throw new Error(`Unsupported file type: ${file.type}`);\n    }\n    \n    try {\n        switch (engine) {\n            case ENGINE_TYPES.TESSERACT:\n                return await processWithTesseract(file, progressCallback);\n                \n            case ENGINE_TYPES.PADDLE_OCR:\n            case ENGINE_TYPES.PPOCR_V5:\n                return await processWithPaddleOCR(file, {\n                    modelId,\n                    presetId,\n                    useCache\n                }, progressCallback);\n                \n            default:\n                throw new Error(`Unknown engine: ${engine}`);\n        }\n    } catch (error) {\n        console.error('OCR processing error:', error);\n        throw error;\n    }\n}\n\n/**\n * Process with Tesseract\n */\nasync function processWithTesseract(file, progressCallback) {\n    const worker = await initializeTesseract(progressCallback);\n    \n    progressCallback?.('Processing with Tesseract...');\n    \n    const result = await worker.recognize(file, {\n        rotateAuto: true\n    });\n    \n    return {\n        text: result.data.text,\n        boxes: result.data.words.map(word => ({\n            text: word.text,\n            bbox: word.bbox,\n            confidence: word.confidence\n        })),\n        lines: result.data.lines.map(line => ({\n            text: line.text,\n            bbox: line.bbox,\n            confidence: line.confidence\n        })),\n        engineName: 'Tesseract',\n        timestamp: new Date().toISOString()\n    };\n}\n\n/**\n * Process with PaddleOCR\n */\nasync function processWithPaddleOCR(file, options, progressCallback) {\n    const { modelId, presetId, useCache } = options;\n    \n    // Initialize or reinitialize with selected model\n    const paddle = await initializePaddleOCR(modelId, presetId, progressCallback);\n    \n    progressCallback?.('Processing with PaddleOCR...');\n    \n    // Process the image\n    const result = await paddle.process(file, {\n        useCache,\n        progressCallback\n    });\n    \n    return result;\n}\n\n/**\n * Update UI with model selection\n */\nfunction updateModelSelection(modelId, presetId) {\n    currentModelId = modelId;\n    currentPresetId = presetId;\n    \n    // Update model info display\n    const modelInfo = engines.paddleOCR?.getSelectedModels();\n    if (modelInfo) {\n        updateModelInfoDisplay(modelInfo);\n    }\n}\n\n/**\n * Update model info display in UI\n */\nfunction updateModelInfoDisplay(modelInfo) {\n    const modelInfoSection = document.getElementById('modelInfoSection');\n    if (!modelInfoSection) return;\n    \n    // Show the section\n    modelInfoSection.style.display = 'block';\n    \n    // Update model paths\n    document.getElementById('selectedDET').textContent = modelInfo.paths.DET;\n    document.getElementById('selectedCLS').textContent = modelInfo.paths.CLS;\n    document.getElementById('selectedREC').textContent = modelInfo.paths.REC;\n    document.getElementById('selectedDICT').textContent = modelInfo.paths.DICT;\n}\n\n/**\n * Clear OCR cache\n */\nfunction clearCache() {\n    ocrCache.clear();\n    console.log('OCR cache cleared');\n}\n\n/**\n * Get cache statistics\n */\nfunction getCacheStats() {\n    return ocrCache.getStats();\n}\n\n/**\n * Cleanup resources\n */\nasync function cleanup() {\n    if (engines.tesseract) {\n        await engines.tesseract.terminate();\n        engines.tesseract = null;\n    }\n    \n    if (engines.paddleOCR) {\n        await engines.paddleOCR.dispose();\n        engines.paddleOCR = null;\n    }\n}\n\n// Export for use in UI\nexport {\n    initializeServiceWorker,\n    processImage,\n    updateModelSelection,\n    clearCache,\n    getCacheStats,\n    cleanup,\n    OCR_MODELS,\n    PRESET_CONFIGS,\n    ENGINE_TYPES,\n    currentEngine,\n    currentModelId,\n    currentPresetId\n};\n\n// Initialize service worker on load\nif (typeof window !== 'undefined') {\n    window.addEventListener('load', () => {\n        initializeServiceWorker();\n    });\n    \n    // Cleanup on unload\n    window.addEventListener('beforeunload', () => {\n        cleanup();\n    });\n}","\n        import { ocrCache } from './src/ocr-cache-manager.js';\n        import { PPOCRv5OnnxEngine } from './src/ppocr-v5-onnx-engine.js';\n        import { AdvancedOCROptions } from './src/onnx-ocr-advanced.js';\n        import './src/main-mantine.js';\n        \n        // Register Service Worker\n        if ('serviceWorker' in navigator) {\n            window.addEventListener('load', () => {\n                navigator.serviceWorker.register('./sw.js')\n                    .then(registration => {\n                        console.log('Service Worker registered:', registration);\n                        \n                        // Check for updates\n                        registration.addEventListener('updatefound', () => {\n                            const newWorker = registration.installing;\n                            newWorker.addEventListener('statechange', () => {\n                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\n                                    showNotification('New version available! Reload to update.', 'info');\n                                }\n                            });\n                        });\n                    })\n                    .catch(err => console.error('Service Worker registration failed:', err));\n            });\n        }\n        \n        // UI Elements\n        const dropzone = document.getElementById('dropzone');\n        const fileInput = document.getElementById('fileInput');\n        const fileList = document.getElementById('fileList');\n        const processBtn = document.getElementById('processBtn');\n        const progressSection = document.getElementById('progressSection');\n        const progressBar = document.getElementById('progressBar');\n        const progressLabel = document.getElementById('progressLabel');\n        const resultsContainer = document.getElementById('resultsContainer');\n        const resultsList = document.getElementById('resultsList');\n        \n        let selectedFiles = [];\n        let currentEngine = null;\n        \n        // Tab functionality\n        document.querySelectorAll('.tab').forEach(tab => {\n            tab.addEventListener('click', () => {\n                const tabName = tab.dataset.tab;\n                \n                // Update active tab\n                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));\n                tab.classList.add('active');\n                \n                // Show corresponding content\n                document.querySelectorAll('.tab-content').forEach(content => {\n                    content.classList.toggle('hidden', content.dataset.content !== tabName);\n                });\n            });\n        });\n        \n        // Dropzone functionality\n        dropzone.addEventListener('click', () => fileInput.click());\n        \n        dropzone.addEventListener('dragover', (e) => {\n            e.preventDefault();\n            dropzone.classList.add('active');\n        });\n        \n        dropzone.addEventListener('dragleave', () => {\n            dropzone.classList.remove('active');\n        });\n        \n        dropzone.addEventListener('drop', (e) => {\n            e.preventDefault();\n            dropzone.classList.remove('active');\n            handleFiles(e.dataTransfer.files);\n        });\n        \n        fileInput.addEventListener('change', (e) => {\n            handleFiles(e.target.files);\n        });\n        \n        function handleFiles(files) {\n            selectedFiles = Array.from(files);\n            updateFileList();\n        }\n        \n        function updateFileList() {\n            if (selectedFiles.length === 0) {\n                fileList.classList.add('hidden');\n                return;\n            }\n            \n            fileList.classList.remove('hidden');\n            fileList.innerHTML = selectedFiles.map((file, index) => `\n                <div class=\"file-item\">\n                    <div class=\"file-info\">\n                        <svg class=\"file-icon\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                            <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"/>\n                            <polyline points=\"14 2 14 8 20 8\"/>\n                        </svg>\n                        <div>\n                            <div class=\"file-name\">${file.name}</div>\n                            <div class=\"file-size\">${formatFileSize(file.size)}</div>\n                        </div>\n                    </div>\n                    <button class=\"button button-subtle\" onclick=\"removeFile(${index})\">\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"/>\n                            <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"/>\n                        </svg>\n                    </button>\n                </div>\n            `).join('');\n        }\n        \n        window.removeFile = function(index) {\n            selectedFiles.splice(index, 1);\n            updateFileList();\n        };\n        \n        function formatFileSize(bytes) {\n            if (bytes === 0) return '0 Bytes';\n            const k = 1024;\n            const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n            const i = Math.floor(Math.log(bytes) / Math.log(k));\n            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n        }\n        \n        // Process button\n        processBtn.addEventListener('click', async () => {\n            if (selectedFiles.length === 0) {\n                showNotification('Please select files to process', 'error');\n                return;\n            }\n            \n            const engineType = document.getElementById('engineSelect').value;\n            const modelVersion = document.getElementById('modelSelect').value;\n            const presetName = document.getElementById('presetSelect').value;\n            const useAngleCls = document.getElementById('angleClassification').checked;\n            const useCache = document.getElementById('cacheResults').checked;\n            \n            progressSection.classList.remove('hidden');\n            resultsContainer.style.display = 'none';\n            resultsList.innerHTML = '';\n            \n            const results = [];\n            \n            for (let i = 0; i < selectedFiles.length; i++) {\n                const file = selectedFiles[i];\n                updateProgress((i / selectedFiles.length) * 100, `Processing ${file.name}...`);\n                \n                try {\n                    // Check cache first\n                    let result = null;\n                    if (useCache) {\n                        const fileData = await fileToBase64(file);\n                        result = ocrCache.get(fileData, engineType, modelVersion);\n                    }\n                    \n                    if (!result) {\n                        // Process the file based on engine type\n                        if (engineType === 'tesseract') {\n                            result = await window.OCREngine.processWithTesseract(file, (msg) => {\n                                updateProgress((i / selectedFiles.length) * 100, msg);\n                            });\n                        } else if (engineType === 'paddleocr') {\n                            const options = {\n                                preset: presetName,\n                                preprocessing: 'improved',\n                                modelVersion: modelVersion\n                            };\n                            result = await window.OCREngine.processWithPaddleOCR(file, options, (msg) => {\n                                updateProgress((i / selectedFiles.length) * 100, msg);\n                                \n                                // Update model info display\n                                if (msg.phase === 'model_selection' && msg.models) {\n                                    updateModelInfo(msg.models);\n                                }\n                            });\n                        } else if (engineType === 'ppocr-v5') {\n                            // Get preset options\n                            const options = presetName !== 'custom' \n                                ? AdvancedOCROptions.mergeWithPreset(presetName, { \n                                    modelName: modelVersion,\n                                    useAngleCls: useAngleCls,\n                                    useCache: useCache\n                                })\n                                : {\n                                    modelName: modelVersion,\n                                    useAngleCls: useAngleCls,\n                                    useCache: useCache\n                                };\n                            \n                            if (!currentEngine || currentEngine.modelName !== modelVersion) {\n                                currentEngine = new PPOCRv5OnnxEngine(options);\n                                await currentEngine.initialize((msg) => {\n                                    updateProgress((i / selectedFiles.length) * 100, msg);\n                                    \n                                    // Update model info display\n                                    if (msg.phase === 'model_selection' && msg.models) {\n                                        updateModelInfo(msg.models);\n                                    }\n                                });\n                            }\n                            \n                            result = await currentEngine.process(file, (msg) => {\n                                updateProgress((i / selectedFiles.length) * 100, msg);\n                            });\n                        }\n                        \n                        // Cache the result\n                        if (useCache && result) {\n                            const fileData = await fileToBase64(file);\n                            ocrCache.set(fileData, engineType, modelVersion, result);\n                        }\n                    }\n                    \n                    results.push({\n                        filename: file.name,\n                        text: result?.text || 'No text detected',\n                        boxes: result?.boxes || []\n                    });\n                } catch (error) {\n                    console.error('Error processing file:', error);\n                    results.push({\n                        filename: file.name,\n                        text: `Error: ${error.message}`,\n                        boxes: []\n                    });\n                }\n            }\n            \n            updateProgress(100, 'Processing complete!');\n            displayResults(results);\n            \n            setTimeout(() => {\n                progressSection.classList.add('hidden');\n            }, 1000);\n        });\n        \n        function updateProgress(percent, label) {\n            progressBar.style.width = percent + '%';\n            progressLabel.textContent = label;\n        }\n        \n        function displayResults(results) {\n            resultsContainer.style.display = 'block';\n            resultsList.innerHTML = results.map((result, index) => `\n                <div class=\"result-item\">\n                    <div class=\"result-header\">\n                        <span class=\"result-filename\">${result.filename}</span>\n                        <button class=\"button button-subtle\" onclick=\"copyText(${index})\">\n                            Copy Text\n                        </button>\n                    </div>\n                    <div class=\"result-text\">${result.text}</div>\n                </div>\n            `).join('');\n            \n            window.results = results;\n        }\n        \n        window.copyText = function(index) {\n            const text = window.results[index].text;\n            navigator.clipboard.writeText(text).then(() => {\n                showNotification('Text copied to clipboard', 'success');\n            });\n        };\n        \n        function updateModelInfo(models) {\n            if (models) {\n                document.getElementById('modelInfoSection').style.display = 'block';\n                document.getElementById('selectedDET').textContent = models.det || '-';\n                document.getElementById('selectedCLS').textContent = models.cls || '-';\n                document.getElementById('selectedREC').textContent = models.rec || '-';\n                document.getElementById('selectedDICT').textContent = models.dict || '-';\n            }\n        }\n        \n        function showNotification(message, type = 'success') {\n            const notification = document.createElement('div');\n            notification.className = `notification notification-${type}`;\n            notification.innerHTML = `\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    ${type === 'success' \n                        ? '<polyline points=\"20 6 9 17 4 12\"/>' \n                        : '<circle cx=\"12\" cy=\"12\" r=\"10\"/><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"/><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"/>'}\n                </svg>\n                <span>${message}</span>\n            `;\n            document.body.appendChild(notification);\n            \n            setTimeout(() => {\n                notification.remove();\n            }, 3000);\n        }\n        \n        async function fileToBase64(file) {\n            return new Promise((resolve, reject) => {\n                const reader = new FileReader();\n                reader.onload = e => resolve(e.target.result);\n                reader.onerror = reject;\n                reader.readAsDataURL(file);\n            });\n        }\n        \n        // Download all results\n        document.getElementById('downloadAllBtn').addEventListener('click', () => {\n            if (!window.results || window.results.length === 0) return;\n            \n            const allText = window.results.map(r => `=== ${r.filename} ===\\n\\n${r.text}\\n\\n`).join('\\n');\n            const blob = new Blob([allText], { type: 'text/plain' });\n            const url = URL.createObjectURL(blob);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = 'ocr-results.txt';\n            a.click();\n            URL.revokeObjectURL(url);\n        });\n        \n        // Initialize\n        showNotification('Smart OCR ready!', 'success');\n    "],"names":["window","define","_","api","o","p","d","fn","s","name","area","key","string","i","id","namespace","store","data","overwrite","testKey","singleArea","delim","ns","force","fill","m","fillList","k","v","list","alt","fillObj","all","val","ret","replacer","changed","type","c","module","this","OCRCacheManager","options","imageData","engineType","modelVersion","keyData","hash","char","entry","ocrResult","dataStr","size","metadata","entries","now","keysToRemove","info","requiredSize","a","b","currentSize","oldest","newest","ocrCache","ImagePreprocessor","targetWidth","targetHeight","canvas","ctx","img","blob","url","resolve","reject","resizedImageData","mean","std","normalized","width","height","chw","idx","h","w","DetectionPreprocessor","originalWidth","originalHeight","resizedCanvas","ratio","ClassificationPreprocessor","channels","resizeWidth","paddedCanvas","paddedCtx","RecognitionPreprocessor","maxWhRatio","imgW","TextRegionExtractor","points","sortedPoints","croppedCanvas","srcPoints","dstPoints","tempCanvas","transform","rotatedCanvas","rotatedCtx","center","acc","point","angleA","angleB","topLeftIdx","minSum","sum","reordered","p1","p2","dx","dy","src","dst","scaleX","scaleY","DBPostProcessor","predictions","shapes","pred","shape","binaryMap","contours","boxes","scores","contour","rect","score","box","rescaledBox","binary","j","visited","startY","startX","queue","directions","y","x","isBoundary","ny","nx","hull","minArea","bestRect","edge","edgeLength","minProj","maxProj","minPerpProj","maxPerpProj","proj","perpProj","corner1","corner2","corner3","corner4","start","sorted","startPoint","distA","distB","xmin","xmax","ymin","ymax","count","polygon","inside","xi","yi","xj","yj","perimeter","distance","expandedBox","prev","curr","next","v1","v2","len1","len2","bisector","bisectorLen","origH","origW","ratioH","ratioW","ClassificationPostProcessor","results","preds","maxIdx","label","CTCDecoder","characterDict","method","indices","lastIdx","t","text","confidence","beamWidth","bestBeam","beams","newBeams","beam","probs","topK","prob","arr","indexed","totalConf","sortBoxes","boxesWithCenter","index","centerX","centerY","item","isGitHubPages","basePath","wasmPath","ort.env","PPOCRv5OnnxEngine","modelBasePath","progressCallback","paths","ort.InferenceSession","fallbackRecPath","error","dictPath","input","cached","detectionResult","sortedBoxes","textResults","regionCanvas","angle","recResult","result","r","preprocessed","feeds","ort.Tensor","output","outputData","predMap","timeSteps","vocabSize","degrees","radians","cacheKey","file","reader","e","AdvancedOCROptions","presetName","customOptions","presets","runtime","exports","Op","hasOwn","defineProperty","obj","desc","undefined","$Symbol","iteratorSymbol","asyncIteratorSymbol","toStringTagSymbol","value","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","context","Context","makeInvokeMethod","tryCatch","arg","err","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","NativeIteratorPrototype","values","Gp","defineIteratorMethods","prototype","genFun","ctor","AsyncIterator","PromiseImpl","invoke","record","unwrapped","previousPromise","enqueue","callInvokeWithMethodAndArg","iter","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","methodName","pushTryEntry","locs","resetTryEntry","object","keys","iterable","iteratorMethod","skipTempReset","rootEntry","rootRecord","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","afterLoc","finallyLoc","tryLoc","thrown","resultName","nextLoc","getId","prefix","cnt","require$$0","jobCounter","createJob","_id","action","payload","logging","log","_logging","args","isElectron","isElectron_1","getEnvironment","env","require","isBrowser","resolveURL","resolvePaths","opts","circularize","page","blocks","paragraphs","lines","words","symbols","block","paragraph","line","word","sym","OEM","defaultOptions","version","require$$1","defaultOptions_1","spawnWorker","workerPath","workerBlobURL","worker","terminateWorker","onMessage","handler","send","packet","readFromBlobOrFile","fileReader","code","loadImage","image","loadImage_1","require$$2","require$$3","require$$4","require$$5","browser","require$$6","workerCounter","createWorker","langs","oem","_options","config","logger","errorHandler","resolves","rejects","currentLangs","currentOem","currentConfig","lstmOnlyCore","workerResReject","workerResResolve","workerRes","workerError","event","setResolve","promiseId","res","setReject","rej","startJob","jobId","load","loadInternal","writeText","path","readText","removeFile","FS","loadLanguage","loadLanguageInternal","_langs","initialize","initializeInternal","_oem","_config","reinitialize","setParameters","params","recognize","getPDF","title","textonly","detect","terminate","workerId","status","resolveObj","Tesseract","REPO_NAME","getAssetUrl","relativePath","cleanPath","isCrossOriginIsolated","initializeServiceWorker","swPath","registration","cleanup","newWorker","showNotification","dropzone","fileInput","fileList","processBtn","progressSection","progressBar","progressLabel","resultsContainer","resultsList","selectedFiles","currentEngine","tab","tabName","content","handleFiles","files","updateFileList","formatFileSize","bytes","sizes","useAngleCls","useCache","updateProgress","fileData","fileToBase64","msg","updateModelInfo","displayResults","percent","models","message","notification","allText"],"mappings":"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","x_google_ignoreList":[0,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]}